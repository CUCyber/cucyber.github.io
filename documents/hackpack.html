<!DOCTYPE html>
<html class="no-js">
    <head>
        <!-- Basic Page Needs
        ================================================== -->
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <link rel="icon" type="image/png" href="/images/shield-small.png">
        <title>CU Cyber - Hackpack</title>
        <link rel="shortcut icon" href="/images/shield-small.png">
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="author" content="">
        <!-- Mobile Specific Metas
        ================================================== -->
        <meta name="format-detection" content="telephone=no">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Template CSS Files
        ================================================== -->
        <!-- Twitter Bootstrs CSS -->
        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <!-- Ionicons Fonts Css -->
        <link rel="stylesheet" href="/css/ionicons.min.css">
        <!-- animate css -->
        <link rel="stylesheet" href="/css/animate.css">
        <!-- Hero area slider css-->
        <link rel="stylesheet" href="/css/slider.css">
        <!-- owl craousel css -->
        <link rel="stylesheet" href="/css/owl.carousel.css">
        <link rel="stylesheet" href="/css/owl.theme.css">
        <link rel="stylesheet" href="/css/jquery.fancybox.css">
        <!-- template main css file -->
        <link rel="stylesheet" href="/css/main.css">
        <!-- responsive css -->
        <link rel="stylesheet" href="/css/responsive.css">

        <!-- Template Javascript Files
        ================================================== -->
        <!-- modernizr js -->
        <script src="/js/vendor/modernizr-2.6.2.min.js"></script>
        <!-- jquery -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <!-- owl carouserl js -->
        <script src="/js/owl.carousel.min.js"></script>
        <!-- bootstrap js -->

        <script src="/js/bootstrap.min.js"></script>
        <!-- wow js -->
        <script src="/js/wow.min.js"></script>
        <!-- slider js -->
        <script src="/js/slider.js"></script>
        <script src="/js/jquery.fancybox.js"></script>
        <!-- template main js -->
        <script src="/js/main.js"></script>

        <!-- Pandoc Styling
        ================================================== -->
        <style type="text/css">
            code {
                white-space: pre-wrap;
                word-wrap: break-word;
            }

            @media (min-width: 768px) {
                *[id]:before {
                    display: block;
                    content: " ";
                    margin-top: -141px;
                    height: 141px;
                    visibility: hidden;
                }
            }
        </style>
                        <style type="text/css">
            div.sourceCode { overflow-x: auto; }
            table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
              margin: 0; padding: 0; vertical-align: baseline; border: none; }
            table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
            td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
            td.sourceCode { padding-left: 5px; }
            pre, code { background-color: #f8f8f8; }
            code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
            code > span.dt { color: #204a87; } /* DataType */
            code > span.dv { color: #0000cf; } /* DecVal */
            code > span.bn { color: #0000cf; } /* BaseN */
            code > span.fl { color: #0000cf; } /* Float */
            code > span.ch { color: #4e9a06; } /* Char */
            code > span.st { color: #4e9a06; } /* String */
            code > span.co { color: #8f5902; font-style: italic; } /* Comment */
            code > span.ot { color: #8f5902; } /* Other */
            code > span.al { color: #ef2929; } /* Alert */
            code > span.fu { color: #000000; } /* Function */
            code > span.er { color: #a40000; font-weight: bold; } /* Error */
            code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
            code > span.cn { color: #000000; } /* Constant */
            code > span.sc { color: #000000; } /* SpecialChar */
            code > span.vs { color: #4e9a06; } /* VerbatimString */
            code > span.ss { color: #4e9a06; } /* SpecialString */
            code > span.im { } /* Import */
            code > span.va { color: #000000; } /* Variable */
            code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
            code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
            code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
            code > span.ex { } /* Extension */
            code > span.at { color: #c4a000; } /* Attribute */
            code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
            code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
            code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
            code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
        </style>
                                <!--[if lt IE 9]>
            <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
        <![endif]-->
        
        <!-- HTTPS JavaScript Redirect -->
        <script>
            if (window.location.hostname != 'localhost' && window.location.hostname != '127.0.0.1' && window.location.protocol != 'https:')
                window.location.protocol = 'https';
        </script>

        <!-- TOC Button JavaScript -->
        <script type="text/javascript">
            $(document).ready(function() {
                $('#top > .btn').click(function() {
                    if ($(this).text() === 'Show')
                        $(this).text('Hide');
                    else
                        $(this).text('Show');
                });
            });
        </script>
    </head>
    <body>
        <!--
        ==================================================
        Header Section Start
        ================================================== -->
        <header id="top-bar" class="navbar-fixed-top animated-header">
            <div class="container">
                <div class="navbar-header">
                    <!-- responsive nav button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <!-- /responsive nav button -->
                    <!-- logo -->
                    <div class="navbar-brand">
                        <a href="/index.html" class="stop-theme">
                            <img src="/images/shield-small.png" alt="CU Cyber">
                            CU Cyber
                        </a>
                    </div>
                    <!-- /logo -->

                </div>
                <!-- main menu -->
                <nav class="collapse navbar-collapse navbar-right" role="navigation">
                    <div class="main-menu">
                        <ul class="flat nav navbar-nav navbar-right">
                            <li>
                                <a href="/index.html">Home</a>
                            </li>
                            <li><a href="/about.html">About</a></li>
                            <li><a href="/events.html">Events</a></li>
                            <li><a href="/contact.html">Contact us</a></li>

                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Useful Resources <span class="caret"></span></a>
                                <div class="dropdown-menu">
                                    <ul class="flat">
                                        <li><a href="/resources.html">Presentations</a></li>
                                        <li><a href="/documents/hackpack.html">Hackpack</a></li>
                                        <li><a href="https://github.com/CUCyber">GitHub</a></li>
                                        <li><a href="https://clemson.collegiatelink.net/organization/cucyber">TigerQuest</a></li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
                <!-- /main nav -->
            </div>
        </header>
        <!--
        ==================================================
            Global Page Section Start
        ================================================== -->
        <section class="global-page-header">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="block">
                            <h2>Hackpack</h2>
                            <ol class="breadcrumb">
                                <li>
                                    <a href="/index.html">
                                        <i class="ion-ios-home"></i>
                                        Home
                                    </a>
                                </li>
                                <li>Documents</li>
                                <li class="active">Cyber Defense Hackpack</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="single-post">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                                                                        <header>
                            <h1>Cyber Defense Hackpack</h1>
                                                                                </header>
                        
                        <p>You can download a PDF of this hackpack <a href="/documents/hackpack.pdf">here</a> and find the Markdown sources of this hackpack on <a href="https://github.com/CUCyber/Hackpack">GitHub</a>.</p>

                                                <h1 id="top">Table of Contents <button data-toggle="collapse" data-target="#TOC" class="btn">Show</button></h1>

                        <nav id="TOC" class="collapse">
                            <ul>
                            <li><a href="#general-information-concerning-the-hackpack">General Information Concerning the Hackpack</a><ul>
                            <li><a href="#the-ten-commandments-of-cyber-defense">The Ten Commandments of Cyber Defense</a></li>
                            </ul></li>
                            <li><a href="#competition-starting-checklists">Competition Starting Checklists</a><ul>
                            <li><a href="#linux-checklist">Linux Checklist</a><ul>
                            <li><a href="#in-depth-hardening">In-Depth Hardening</a></li>
                            </ul></li>
                            <li><a href="#windows-checklist">Windows Checklist</a></li>
                            </ul></li>
                            <li><a href="#administrative-correspondence">Administrative Correspondence</a><ul>
                            <li><a href="#incident-response-and-report">Incident Response and Report</a></li>
                            <li><a href="#handling-business-injects">Handling Business Injects</a></li>
                            </ul></li>
                            <li><a href="#authentication-modules-and-network-protocols">Authentication Modules and Network Protocols</a><ul>
                            <li><a href="#kerberos">Kerberos</a><ul>
                            <li><a href="#installation">Installation</a></li>
                            </ul></li>
                            <li><a href="#login.defs">login.defs</a><ul>
                            <li><a href="#best-practices">Best Practices</a></li>
                            </ul></li>
                            <li><a href="#pam">PAM</a><ul>
                            <li><a href="#configuration">Configuration</a></li>
                            </ul></li>
                            <li><a href="#sudo">Sudo</a><ul>
                            <li><a href="#configuration-1">Configuration</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#backups-and-restoration">Backups and Restoration</a><ul>
                            <li><a href="#rsnapshot">rsnapshot</a><ul>
                            <li><a href="#summary">Summary</a></li>
                            <li><a href="#configuration-2">Configuration</a></li>
                            </ul></li>
                            <li><a href="#simple-backups">Simple Backups</a><ul>
                            <li><a href="#summary-1">Summary</a></li>
                            <li><a href="#commands">Commands</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#disaster-recovery">Disaster Recovery</a><ul>
                            <li><a href="#linux">Linux</a><ul>
                            <li><a href="#invalid-password">Invalid Password</a></li>
                            <li><a href="#chmod-not-executable">Chmod Not Executable</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#filesystem-layout-and-locations">Filesystem Layout and Locations</a><ul>
                            <li><a href="#linux-filesystem-hierarchy">Linux Filesystem Hierarchy</a></li>
                            </ul></li>
                            <li><a href="#dedicated-firewalls-system-firewalls-and-packet-filters">Dedicated Firewalls, System Firewalls, and Packet Filters</a><ul>
                            <li><a href="#firewall-basics">Firewall Basics</a></li>
                            <li><a href="#firewalld">FirewallD</a><ul>
                            <li><a href="#config-files">Config Files</a></li>
                            <li><a href="#commands-1">Commands</a></li>
                            <li><a href="#filtering">Filtering</a></li>
                            <li><a href="#example-configuration">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#iptables">iptables</a><ul>
                            <li><a href="#config-files-1">Config Files</a></li>
                            <li><a href="#commands-2">Commands</a></li>
                            <li><a href="#filtering-1">Filtering</a></li>
                            <li><a href="#example-configuration-1">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#palo-alto">Palo Alto</a><ul>
                            <li><a href="#lights-out">Lights Out</a></li>
                            <li><a href="#basic-commands">Basic Commands</a></li>
                            <li><a href="#rules">Rules</a></li>
                            </ul></li>
                            <li><a href="#pf">pf</a><ul>
                            <li><a href="#config-files-2">Config Files</a></li>
                            <li><a href="#commands-3">Commands</a></li>
                            <li><a href="#filtering-2">Filtering</a></li>
                            <li><a href="#example-configuration-2">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#uncomplicated-firewall">Uncomplicated Firewall</a><ul>
                            <li><a href="#config-files-3">Config Files</a></li>
                            <li><a href="#commands-4">Commands</a></li>
                            <li><a href="#sample-usage">Sample Usage</a></li>
                            <li><a href="#filtering-3">Filtering</a></li>
                            <li><a href="#example-configuration-3">Example Configuration</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#logging-investigation-and-auditing">Logging, Investigation, and Auditing</a><ul>
                            <li><a href="#auditd">auditd</a><ul>
                            <li><a href="#installation-1">Installation</a></li>
                            <li><a href="#config-files-4">Config Files</a></li>
                            <li><a href="#commands-5">Commands</a></li>
                            <li><a href="#example-configuration-4">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#rsyslog">Rsyslog</a><ul>
                            <li><a href="#config-files-5">Config Files</a></li>
                            </ul></li>
                            <li><a href="#script">Script</a><ul>
                            <li><a href="#usage">Usage</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#operating-system-utilities">Operating System Utilities</a><ul>
                            <li><a href="#advanced-packaging-tool-apt">Advanced Packaging Tool (apt)</a><ul>
                            <li><a href="#archive-mirrors">Archive Mirrors</a></li>
                            </ul></li>
                            <li><a href="#sh">sh</a><ul>
                            <li><a href="#backgrounding">Backgrounding</a></li>
                            <li><a href="#scripting">Scripting</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#filesystem-and-access-control-permissions">Filesystem and Access Control Permissions</a><ul>
                            <li><a href="#dev">/dev</a></li>
                            <li><a href="#home">/home</a></li>
                            <li><a href="#varwww">/var/www</a></li>
                            </ul></li>
                            <li><a href="#provisioners">Provisioners</a><ul>
                            <li><a href="#ansible">Ansible</a><ul>
                            <li><a href="#setting-it-up">Setting it Up</a></li>
                            <li><a href="#inventory-management">Inventory Management</a></li>
                            <li><a href="#sample-playbooks">Sample Playbooks</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#scripts-and-other-useful-snippets">Scripts and Other Useful Snippets</a><ul>
                            <li><a href="#add-group">Add Group</a></li>
                            <li><a href="#bulk-users">Bulk Users</a></li>
                            <li><a href="#parallel">Parallel</a></li>
                            </ul></li>
                            <li><a href="#system-services-and-network-applications">System Services and Network Applications</a><ul>
                            <li><a href="#apache">Apache</a><ul>
                            <li><a href="#installation-2">Installation</a></li>
                            <li><a href="#remove-override-functionality">Remove Override Functionality</a></li>
                            <li><a href="#chrooting">Chrooting</a></li>
                            <li><a href="#configuring-ssl">Configuring SSL</a></li>
                            <li><a href="#prevent-leaking-web-application-data">Prevent Leaking Web Application Data</a></li>
                            </ul></li>
                            <li><a href="#bind">BIND</a><ul>
                            <li><a href="#config-files-6">Config Files</a></li>
                            <li><a href="#example-configuration-5">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#mysql">MySQL</a><ul>
                            <li><a href="#installation-3">Installation</a></li>
                            <li><a href="#common-tasks">Common Tasks</a></li>
                            </ul></li>
                            <li><a href="#openssl">OpenSSL</a><ul>
                            <li><a href="#generate-tls-certificates">Generate TLS Certificates</a></li>
                            </ul></li>
                            <li><a href="#postfix">Postfix</a><ul>
                            <li><a href="#full-mta">Full MTA</a></li>
                            <li><a href="#send-only">Send Only</a></li>
                            </ul></li>
                            <li><a href="#samba">Samba</a><ul>
                            <li><a href="#example-configuration-6">Example Configuration</a></li>
                            </ul></li>
                            <li><a href="#openssh">OpenSSH</a><ul>
                            <li><a href="#best-practices-1">Best Practices</a></li>
                            <li><a href="#config-files-7">Config Files</a></li>
                            <li><a href="#configuration-3">Configuration</a></li>
                            </ul></li>
                            <li><a href="#apache-tomcat">Apache Tomcat</a><ul>
                            <li><a href="#installation-4">Installation</a></li>
                            <li><a href="#configuration-4">Configuration</a></li>
                            </ul></li>
                            <li><a href="#vsftpd">VSFTPD</a></li>
                            <li><a href="#wordpress">Wordpress</a><ul>
                            <li><a href="#setup">Setup</a></li>
                            <li><a href="#securing-1">Securing</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#sniffers-and-information-gathering">Sniffers and Information Gathering</a><ul>
                            <li><a href="#nmap">Nmap</a><ul>
                            <li><a href="#common-options">Common Options</a></li>
                            </ul></li>
                            <li><a href="#wireshark">Wireshark</a><ul>
                            <li><a href="#color-scheme">Color Scheme</a></li>
                            <li><a href="#capture-filters">Capture Filters</a></li>
                            </ul></li>
                            </ul></li>
                            <li><a href="#appendix">Appendix</a><ul>
                            <li><a href="#copyright">Copyright</a><ul>
                            <li><a href="#creative-commons-attribution-sharealike-4.0-international-public-license">Creative Commons Attribution-ShareAlike 4.0 International Public License</a></li>
                            <li><a href="#bsd-2-clause">BSD 2-Clause</a></li>
                            <li><a href="#the-mit-license">The MIT License</a></li>
                            </ul></li>
                            </ul></li>
                            </ul>
                        </nav>
                                                <h1 id="general-information-concerning-the-hackpack">General Information Concerning the Hackpack</h1>
<h2 id="the-ten-commandments-of-cyber-defense">The Ten Commandments of Cyber Defense</h2>
<ol style="list-style-type: decimal">
<li>Thou shalt NEVER trust the red team</li>
<li>Thou shalt trust but verify everything else</li>
<li>Thou shalt know thy network</li>
<li>Thou shalt patch thy services</li>
<li>Thou shalt make frequent backups</li>
<li>Thou shalt disable unused services</li>
<li>Thou shalt set and use strong passwords</li>
<li>Thou shalt always use a firewall</li>
<li>Thou shalt log everything</li>
<li>Thou shalt get your injects done on time</li>
</ol>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="competition-starting-checklists">Competition Starting Checklists</h1>
<h2 id="linux-checklist">Linux Checklist</h2>
<p>This checklist is designed for the first 30 minutes of competition.</p>
<p>For each system:</p>
<ul>
<li>Check for users
<ul>
<li><code>cat /etc/passwd</code></li>
</ul></li>
<li>Change the password for the root account
<ul>
<li><code>type passwd</code></li>
<li><code>cat &lt;path to passwd&gt;</code></li>
<li><code>passwd &lt;user&gt;</code></li>
</ul></li>
<li>Check for improper ssh config
<ul>
<li><code>ls ~/.ssh</code></li>
</ul></li>
<li>Check for improper sshd config
<ul>
<li><code>/etc/ssh/sshd_config</code></li>
</ul></li>
<li>Check the crontab(s) for running tasks
<ul>
<li><code>crontab -l</code></li>
<li><code>crontab -e</code></li>
<li>not much should be there</li>
</ul></li>
<li>Check for files with wide permissions and setuid
<ul>
<li>setuid bit: <code>find &lt;dir&gt; -perm -u=s</code></li>
<li>world writable: <code>find &lt;dir&gt; -perm -o=w</code></li>
</ul></li>
<li>Create a report of running processes
<ul>
<li><code>ps aux</code></li>
</ul></li>
<li>Create a report of running services
<ul>
<li><code>ss -tlnp</code></li>
<li><code>ss -ulnp</code></li>
</ul></li>
<li>Audit users and groups for invalid entries
<ul>
<li><code>cat /etc/passwd</code></li>
<li><code>cat /etc/shadow</code></li>
<li><code>cat /etc/group</code></li>
</ul></li>
<li>Check mounted filesystems
<ul>
<li><code>lsblk</code></li>
</ul></li>
<li>Install important system and security updates
<ul>
<li>OpenSSL</li>
<li>OpenSSH</li>
<li>web server</li>
<li>file server</li>
<li>mail server</li>
<li>DNS server</li>
<li>Linux kernel (not necessarily to latest major version but to latest security update) - requires reboot</li>
</ul></li>
<li>Run a full system backup
<ul>
<li>See 'Backups and Restoration' -&gt; 'Simple Backups'</li>
</ul></li>
<li>Check and configure '/etc/sudoers' and '/etc/sudoers.d/*'</li>
<li>Harden the service(s) for your machine
<ul>
<li>Check for misconfigured files</li>
</ul></li>
<li>Install and configure a firewall</li>
<li>Check filesystem for proper layout and for any odd files
<ul>
<li>See 'Filesystem Layout and Locations' -&gt; 'Linux Filesystem Hierarchy'</li>
</ul></li>
<li>Write an audit report containing changes made</li>
</ul>
<p>For all systems:</p>
<ul>
<li>Scan the subnet for running servers</li>
</ul>
<h3 id="in-depth-hardening">In-Depth Hardening</h3>
<ul>
<li>Ensure '/tmp' is a seperate partition with nodev,nosuid</li>
<li>Ensure '/var' is a seperate partition</li>
<li>Ensure '/var/log' is a separate partition</li>
<li>Ensure '/var/log/audit' is a separate partition</li>
<li>Ensure '/home' is a seperate partition with nodev</li>
<li>Ensure '/run/shm' is <code>nodev,nosuid,noexec</code></li>
<li>Bind mount '/var/tmp' to '/tmp'</li>
<li>Require a password for root</li>
<li>Set hard core limit to <code>0</code> in '/etc/security/limits.conf'</li>
<li>Disable rarely used filesystems and protocols</li>
</ul>
<h4 id="modprobe">Modprobe</h4>
<h5 id="etcmodprobe.dsecure.conf">/etc/modprobe.d/secure.conf</h5>
<pre class="conf"><code>install cramfs /bin/true
install freevxfs /bin/true
install jffs2 /bin/true
install hfs /bin/true
install hfsplus /bin/true
install squashfs /bin/true
install udf /bin/true

install dccp /bin/true
install sctp /bin/true
install tipc /bin/true</code></pre>
<h4 id="sysctl">Sysctl</h4>
<ul>
<li>Enable ASLR <code>/sbin/sysctl kernel.randomize_va_space = 2</code></li>
<li>Disable network forwarding <code>/sbin/sysctl -w net.ipv4.ip_forward 0</code></li>
<li>Disable packet redirects <code>/sbin/sysctl -w net.conf.default.send_redirects 0</code></li>
<li>Flush packet redirects <code>/sbin/sysctl -w net.ipv4.conf.all.send_redirects 0</code></li>
<li>Flush packet redirects <code>/sbin/sysctl -w net.ipv4.conf.all.send_redirects 0</code></li>
<li>Disable source routed packets <code>/sbin/sysctl -w net.ipv4.conf.all.accept_source_route 0</code></li>
<li>Disable source routed packets <code>/sbin/sysctl -w net.ipv4.conf.default.accept_source_route 0</code></li>
<li>Disable ICMP redirect acceptance <code>/sbin/sysctl -w net.ipv4.conf.all.accept_redirects 0</code></li>
<li>Disable ICMP redirect acceptance <code>/sbin/sysctl -w net.ipv4.conf.default.accept_redirects 0</code></li>
<li>Disable secure ICMP redirect acceptance <code>/sbin/sysctl -w net.ipv4.conf.default.secure_redirects 0</code></li>
<li>Disable secure ICMP redirect acceptance <code>/sbin/sysctl -w net.ipv4.conf.default.secure_redirects 0</code></li>
<li>Disable ICMP broadcast requests <code>/sbin/sysctl -w net.ipv4.icmp_echo_ignore_broadcasts 1</code></li>
<li>Disable ICMP bad error message protection <code>/sbin/sysctl -w net.ipv4.icmp_ignore_bogus_error_responces 1</code></li>
<li>Force source route validation <code>/sbin/sysctl -w net.ipv4.conf.all.rp_filter 1</code></li>
<li>Force source route validation <code>/sbin/sysctl -w net.ipv4.conf.default.rp_filter 1</code></li>
<li>Use tcp syncookies <code>/sbin/sysctl -w net.ipv4.tcp_syncookies 1</code></li>
<li>Log suspicious packets <code>/sbin/sysctl -w net.ipv4.conf.all.log_martians 1</code></li>
<li>Log suspicious packets <code>/sbin/sysctl -w net.ipv4.conf.default.log_martians 1</code></li>
<li>Flush routing tables <code>/sbin/sysctl -w net.ipv4.route.flush 1</code></li>
<li>Disable IPv6 router advertisements <code>/sbin/sysctl -w net.ipv6.conf.all.accept_ra 0</code></li>
<li>Disable IPv6 router advertisements <code>/sbin/sysctl -w net.ipv6.conf.default.accept_ra 0</code></li>
<li>Disable IPv6 redirect acceptance <code>/sbin/sysctl -w net.ipv5.confi.all.accept_redirects 0</code></li>
<li>Disable IPv6 redirect acceptance <code>/sbin/sysctl -w net.ipv5.confi.default.accept_redirects 0</code></li>
</ul>
<h4 id="authentication">Authentication</h4>
<ul>
<li>Do not allow '.' to be in root's <code>PATH</code> environment variable (check in '/etc/login.defs', '/etc/profile', and '/etc/profile.d')</li>
<li>Set the shell on unused users to '/bin/nologin'</li>
<li>Ensure '/etc/passwd' is <code>root:root</code> <code>0600</code> and contains no lines of +</li>
<li>Ensure '/etc/group' is <code>root:root</code> <code>0600</code> and contains no lines of +</li>
<li>Ensure '/etc/shadow' is <code>root:root</code> <code>0600</code> and contains no lines of +</li>
<li>Ensure users own thier home directories with sane permissions</li>
<li>Use PAM
<ul>
<li>Configure <code>pam_cracklib retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1</code></li>
<li>Configure <code>pam_unix obscure sha512 remember=5</code></li>
<li>No empty passwords</li>
</ul></li>
<li>Restrict access to su
<ul>
<li><code>echo &quot;auth required pam_wheel.so use_uid&quot; &gt;&gt; /etc/pam.d/su</code></li>
</ul></li>
<li>Use '/etc/login.defs'
<ul>
<li>Set <code>PASS_MAX_DAYS</code>, <code>PASS_MIN_DAYS</code>, <code>PASS_WARN_DAYS</code></li>
</ul></li>
<li>Verify root is the only uid <code>0</code> account</li>
<li>Verify root, sync, shutdown, halt, and operator are the only gid <code>0</code> accounts</li>
<li>Verify no duplicate gid</li>
<li>Verify no duplicate usernames or group names</li>
<li>Delete all '.forward' files</li>
<li>Ensure 'shadow' group is empty</li>
<li>Check for '.rhosts' and '.netrc'</li>
</ul>
<h4 id="permissions">Permissions</h4>
<ul>
<li>No world writable files
<ul>
<li><code>find / -perm -o=w</code></li>
</ul></li>
<li>Find un-owned files
<ul>
<li><code>find / -nouser -o -nogroup</code></li>
</ul></li>
<li>Find suid binaries
<ul>
<li><code>find / -perm -u=s</code></li>
</ul></li>
<li>Find sgid binaries
<ul>
<li><code>find / -perm -g=s</code></li>
</ul></li>
<li>Use a umask of 077 to prohibit users from reading files that are not theirs (see '/etc/profile')</li>
<li>Ensure bootloader config, '/boot/grub/grub.cfg', is owned by <code>root:root</code> and has permissions <code>0600</code></li>
</ul>
<h4 id="programs">Programs</h4>
<ul>
<li>If <code>prelink</code> is installed, run <code>/usr/sbin/prelink -ua</code> and uninstall it</li>
<li>Where possible, uninstall Xorg</li>
<li>Ensure rshd, rlogind, rexecd, talk, telnet, tftp, xinetd, chargen, daytime, echo, discard, avahi, cupsd, isc-dhcp-server, ldap, nfs, rpc, bind, vsftpd, apache, dovecot, smbd, squid3, snmp, rsyncd are disabled, and preferably uninstalled, where possible</li>
<li>Configure ntp</li>
<li>Create '/etc/hosts.{allow,deny}' files with permissions 0644</li>
<li>Disable wireless on wired devices</li>
<li>Ensure a firewall is running</li>
<li>Use install and use auditd
<ul>
<li>Set <code>max_log_file = &lt;megabytes&gt;</code></li>
<li>Use audit to detect time changes, user and group changes, network changes, AppArmor/SELinux, login/logout, sessions, changes to file permissions, unautorized access attempts, priviliged commands, successful mounts, file deletion events, sudoers, kernel module changes</li>
</ul></li>
<li>Use and install rsyslog and configure it to save logs to '/var/log' with appropriate permissions, usually <code>root:root</code> <code>0600</code>
<ul>
<li>Consolidate logs if possible with remote logging</li>
</ul></li>
<li>Use AIDE/Tripwire</li>
<li>Use cron where necessary with <code>root:root</code> <code>0600</code> permissions</li>
<li>Setup SSH
<ul>
<li>Set enviroment options No</li>
<li>Prohibit inactive sessions
<ul>
<li>ClientAliveInterval 300</li>
<li>ClientAliveCountMax 0</li>
</ul></li>
</ul></li>
</ul>
<h5 id="etcntp.conf">/etc/ntp.conf</h5>
<pre class="conf"><code>restrict -4 default kod nomodify notrap nopeer noquery
restrict -6 default kod nomodify notrap nopeer noquery</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="windows-checklist">Windows Checklist</h2>
<p>This checklist is designed for the first 30 minutes of competition.</p>
<p>For each system:</p>
<ul>
<li>Change the password for the admin accounts</li>
<li>Remove any nonessential user accounts</li>
<li>Check the startup list</li>
<li>Check the event logs</li>
<li>Create a report of all running services</li>
<li>Create a report of all open ports</li>
<li>Install Windows service packages</li>
<li>Run a full backup of the system</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="administrative-correspondence">Administrative Correspondence</h1>
<h2 id="incident-response-and-report">Incident Response and Report</h2>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="handling-business-injects">Handling Business Injects</h2>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="authentication-modules-and-network-protocols">Authentication Modules and Network Protocols</h1>
<h2 id="kerberos">Kerberos</h2>
<p>Kerberos is a remote login service that allows a set of Linux and Windows servers to share users and groups. The current version of the protocol is version 5, and version 4 is deprecated and should not be used due to weak cryptography.</p>
<h3 id="installation">Installation</h3>
<p>Kerberos can be configured to either authenticate against either Linux or a Windows Active Directory server.</p>
<p>Here is how to install and configure Kerberos to run on Linux:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># if you can, use realmd (newer servers)</span>
<span class="ex">realm</span> discover
<span class="ex">realm</span> join <span class="st">&quot;realm_name&quot;</span>
<span class="ex">realm</span> permit -a

<span class="co"># which roughly does the following on the backend</span>

<span class="co">#####################################################################</span>
<span class="co">##this section is roughly based on the ArchLinux Wiki documentation##</span>
<span class="co">##Which is available under the GNU Free Document License           ##</span>
<span class="co">#####################################################################</span>
<span class="co"># first install and configure NTP and name resolution for the servers</span>
<span class="co"># next, configure the /etc/krb5.conf file as shown below</span>

<span class="co"># verify that you can now login</span>
<span class="ex">kinit</span> administrator@EXAMPLE.COM
<span class="ex">klist</span>

<span class="co"># if there are errors regarding a missing pam_winbind make a file called</span>
<span class="co"># &#39;pam_winbind.conf&#39; with the contents of the next section</span>

<span class="co"># configure Samba as specified in the Samba series section</span>

<span class="ex">net</span> ads join -U Administartor

<span class="co"># start and enable the required services</span>
<span class="ex">systemctl</span> start smbd nmbd winbindd

<span class="co"># configure /etc/nsswitch.conf as shown below</span>

<span class="co"># test winbind and nss(Windows Authentication service)</span>
<span class="ex">wbinfo</span> -u
<span class="ex">wbinfo</span> -g
<span class="fu">getent</span> passwd
<span class="fu">getent</span> group
<span class="ex">net</span> ads info
<span class="ex">net</span> ads lookup
<span class="ex">net</span> ads status -U administrator

<span class="co"># configure PAM with the following config.</span>

<span class="co"># modify applications as necessary to use Kerberos</span>
<span class="co"># see the specific application for documentation</span>

<span class="co"># finally configure smb shares and keytabs if desired using the following</span></code></pre></div>
<h4 id="etcpam_winbind.conf">/etc/pam_winbind.conf</h4>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="kw">[global]</span>
<span class="dt">  debug </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">  debug_state </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">  try_first_pass </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">  krb5_auth </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">  krb5_cache_type </span><span class="ot">=</span><span class="st"> FILE</span>
<span class="dt">  cached_login </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">  silent </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">  mkhomedir </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span></code></pre></div>
<h4 id="etcpam.dkrb5">/etc/pam.d/krb5</h4>
<pre class="pam"><code>#%PAM-1.0

auth [success=1 default=ignore] pam_localuser.so
auth [success=2 default=die] pam_winbind.so
auth [success=1 default=die] pam_unix.so nullok
auth requisite pam_deny.so
auth      optional  pam_permit.so
auth      required  pam_env.so


account   required  pam_unix.so
account [success=1 default=ignore] pam_localuser.so
account required pam_winbind.so
account   optional  pam_permit.so
account   required  pam_time.so

password [success=1 default=ignore] pam_localuser.so
password [success=2 default=die] pam_winbind.so
password [success=1 default=die] pam_unix.so sha512 shadow
password requisite pam_deny.so
password  optional  pam_permit.so

session   required  pam_limits.so
session required pam_mkhomedir.so skel=/etc/skel/ umask=0022
session   required  pam_unix.so
session [success=1 default=ignore] pam_localuser.so
session required pam_winbind.so
session   optional  pam_permit.so</code></pre>
<h4 id="etckrb5.conf">/etc/krb5.conf</h4>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="kw">[libdefaults]</span>
<span class="dt">    </span><span class="co">#Default Realm must be unique on the network, by convention it is all caps</span>
<span class="dt">    default_realm </span><span class="ot">=</span><span class="st"> EXAMPLE.COM</span>
<span class="dt">    </span><span class="co">#if Windows Server 2008 and older require weak crypto; Think carefully before using</span>
<span class="dt">    allow_weak_crypto </span><span class="ot">=</span><span class="st"> </span><span class="kw">true</span>

<span class="kw">[realms]</span>
<span class="dt">    EXAMPLE.COM </span><span class="ot">=</span><span class="st"> {</span>
<span class="dt">        </span><span class="co">#host where the auth server is running given as a fqdm:port</span>
<span class="dt">        admin_server </span><span class="ot">=</span><span class="st"> kerberos_server.example.com:</span><span class="dv">749</span>
<span class="dt">        </span><span class="co">#Name(s) of a host running a Kerberos Key Distribution Server</span>
<span class="dt">        </span><span class="co">#These are nessisary if realm admins don&#39;t have SRV records in DNS</span>
<span class="dt">        kdc </span><span class="ot">=</span><span class="st"> kerberos_server.example.com:</span><span class="dv">88</span>
<span class="dt">        kdc </span><span class="ot">=</span><span class="st"> kerberos_server2.example.com:</span><span class="dv">88</span>
<span class="dt">    }</span>
<span class="kw">[domain_realm]</span>
<span class="dt">    </span><span class="co">#maps host names to kerberos realms</span>
<span class="dt">    </span><span class="co">#domains beginning with a . include all subdomains of the specified domain</span>
<span class="dt">    .example.com </span><span class="ot">=</span><span class="st"> EXAMPLE.COM</span>
<span class="dt">    example.com </span><span class="ot">=</span><span class="st"> EXAMPLE.COM</span>

<span class="kw">[logging]</span>
<span class="dt">    default </span><span class="ot">=</span><span class="st"> FILE:/var/log/krb5libs.log</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="login.defs">login.defs</h2>
<p>'/etc/login.defs' is a configuration file that controls login functionality on Linux machines using encrypted password files. It is one of 3 tools that can control this process (login.defs, pam, systemd-logind).</p>
<h3 id="best-practices">Best Practices</h3>
<h4 id="etclogin.defs">/etc/login.defs</h4>
<ul>
<li>set <code>CONSOLE</code> to <code>/etc/securetty</code></li>
<li>set <code>PASS_MAX_DAYS</code> to 30</li>
<li>set <code>PASS_MIN_DAYS</code> to 7</li>
<li>set <code>PASS_WARN_DAYS</code> to 8</li>
<li>set <code>PASS_MIN_LEN</code> to 8</li>
<li>set <code>MAIL_DIR</code> to <code>/var/spool/mail</code></li>
<li>set <code>UMASK</code> to 077</li>
</ul>
<h4 id="etcsecuretty">/etc/securetty</h4>
<pre class="conf"><code>console
tty1
tty2
tty3
tty4
tty5
tty6</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="pam">PAM</h2>
<p>PAM is short for Pluggable Authentication Module. It controls the authentication on Linux machines. By default, it reads the '/etc/shadow' file. It can also be configured to use LDAP or Kerberos for remote authentication.</p>
<p>In general the following should be configured:</p>
<ul>
<li>use <code>pam_cracklib retry=3 minlen=14 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1</code></li>
<li>use <code>pam_unix obscure sha512 remember=5</code></li>
</ul>
<h3 id="configuration">Configuration</h3>
<h4 id="etcpam.dsystem-auth">/etc/pam.d/system-auth</h4>
<pre class="pam"><code>auth required pam_env.so
auth required pam_unix.so try_first_pass likeauth nullokf
auth required /lib/security/\$ISA/pam_tally.so onerr=fail no_magic_root

account required pam_unix.so
account required /lib/security/\$ISA/pam_tally.so per_user_deny=5 no_magic_root reset

password required pam_cracklib.so retry=3 minlength=8 difok=3
password required pam_unix.so try_first_pass use_authtok sha512 shadow

session required pam_limits.so
session required pam_env.so
session required pam_unix.so</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="sudo">Sudo</h2>
<p>Sudo is short for super user do. It allows for non-root users to request elevated privileges on linux systems. Sudo has a variety of options that can be configured.</p>
<p>Here are some basic suggestions for managing systems that use sudo:</p>
<ul>
<li>Limit users permissions where possible, users should not have <code>ALL = (ALL) ALL</code></li>
<li>Avoid using groups with root permissions</li>
</ul>
<p>The '/etc/sudoers' file should be edited as root using the <code>visudo</code> command which verifies the syntax before making changes. There are also other configuration files that can be found in '/etc/sudoers.d/'. These can be edited using <code>visudo -f &lt;filename&gt;</code>.</p>
<h3 id="configuration-1">Configuration</h3>
<p>The following script will create a sane configuration for sudo.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="fu">cp</span> -Ra /etc/sudoers.d /etc/sudoers.d~
<span class="ex">groupdel</span> wheel <span class="kw">&amp;&amp;</span> <span class="ex">groupadd</span> wheel
<span class="fu">cp</span> -a /etc/sudoers /etc/sudoers~
<span class="fu">cat</span> <span class="op">&gt;</span>/etc/sudoers &lt;&lt;- EOF
root ALL=(ALL) ALL
%wheel ALL=(ALL) ALL
EOF

chown root:root /etc/<span class="op">s</span><span class="ex">udoers</span>
chmod 600 /etc/<span class="op">s</span><span class="ex">udoers</span>

# be <span class="op">s</span><span class="ex">ure</span> to add administrators back to <span class="st">&#39;wheel&#39;</span> and
# m<span class="op">e</span><span class="ex">rge</span> stuff from <span class="st">&#39;/etc/sudoers~&#39;</span> and <span class="st">&#39;/etc/sudoers.d~/&#39;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="backups-and-restoration">Backups and Restoration</h1>
<h2 id="rsnapshot">rsnapshot</h2>
<h3 id="summary">Summary</h3>
<p>rnapshot is a utility to create incremental snapshot backups using rsync. It has minimal dependencies and should work even on very old Linux distributions.</p>
<h4 id="dependencies">Dependencies</h4>
<ul>
<li>perl</li>
<li>rsync</li>
<li>openssh</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="configuration-2">Configuration</h3>
<h4 id="etcrsnapshot.dsystem">/etc/rsnapshot.d/system</h4>
<pre class="rsnapshot"><code>config_version  1.2

no_create_root  1
lockfile    /var/run/rsnapshot.pid

cmd_cp      /bin/cp
cmd_rm      /bin/rm
cmd_rsync   /usr/bin/rsync
cmd_ssh     /usr/bin/ssh
link_dest   1

one_fs      1

snapshot_root   /mnt/backup/

retain      system  8

exclude     /dev/**
exclude     /proc/**
exclude     /sys/**

exclude     /tmp/**

exclude     /var/cache/**
exclude     /var/lock/**
exclude     /var/run/**
exclude     /var/tmp/**

exclude     /usr/portage/distfiles/**

backup      root@example.local:/    example.local/</code></pre>
<h4 id="etcrsnapshot.dapplication">/etc/rsnapshot.d/application</h4>
<pre class="rsnapshot"><code>config_version  1.2

no_create_root  1
lockfile    /var/run/rsnapshot.pid

cmd_cp      /bin/cp
cmd_rm      /bin/rm
cmd_rsync   /usr/bin/rsync
cmd_ssh     /usr/bin/ssh
link_dest   1

one_fs      1

snapshot_root   /mnt/backup/

retain      application 8

exclude     /dev/**
exclude     /proc/**
exclude     /sys/**

exclude     /tmp/**

exclude     /var/cache/**
exclude     /var/lock/**
exclude     /var/run/**
exclude     /var/tmp/**

exclude     /usr/portage/distfiles/**

backup      root@example.local:/etc/    example.local/
backup      root@example.local:/opt/    example.local/
backup      root@example.local:/var/    example.local/</code></pre>
<h4 id="etccron.drsnapshot">/etc/cron.d/rsnapshot</h4>
<pre class="crontab"><code>0,15,30,45 * * * * root rsnapshot -c /etc/rsnapshot.d/application application
8 * * * * root rsnapshot -c /etc/rsnapshot.d/system system</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="simple-backups">Simple Backups</h2>
<h3 id="summary-1">Summary</h3>
<p>To create simple archive backups, use the tar command. These backups should be created as the initial backups during the beginning period of the competition.</p>
<h4 id="dependencies-1">Dependencies</h4>
<ul>
<li>tar</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands">Commands</h3>
<h4 id="backup">Backup</h4>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="ex">useradd</span> flynn
<span class="fu">mkdir</span> -p /home/flynn/
<span class="fu">tar</span> cjpf /home/flynn/kevin \
    --exclude=<span class="dt">{/sys/*,/dev/*,/proc/*,/tmp/*,/run/*}</span> \
    --exclude=/home/flynn/* /
<span class="fu">chown</span> flynn:flynn /home/flynn/kevin
<span class="fu">chmod</span> 640 /home/flynn/kevin</code></pre></div>
<h4 id="extract">Extract</h4>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="fu">tar</span> xjpf /home/flynn/kevin --wildcards <span class="st">&quot;</span><span class="va">$@</span><span class="st">&quot;</span></code></pre></div>
<h4 id="restore">Restore</h4>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="bu">cd</span> /
<span class="fu">tar</span> xjpf /home/flynn/kevin</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="disaster-recovery">Disaster Recovery</h1>
<h2 id="linux">Linux</h2>
<p>Here are some of the worst things that they can do, and how to hopefully recover.</p>
<h3 id="invalid-password">Invalid Password</h3>
<p>The red team has changed the password to the root account.</p>
<ol style="list-style-type: decimal">
<li>Reboot and hold shift</li>
<li>Press 'e' at the grub prompt to edit the kernel command line</li>
<li>Add the option <code>init=/bin/bash</code> to the line that says linux</li>
<li>Mount the root filesystem, <code>mount -o remout,rw /</code></li>
<li>Use 'vi' to edit the <code>/etc/passwd</code> file and remove the 'x' between the 2nd and 3rd colon on the root user</li>
<li>Write the file</li>
<li>Use 'passwd' to create a new root password</li>
<li>Reboot</li>
</ol>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="chmod-not-executable">Chmod Not Executable</h3>
<p>While this initially might not seem like it is too bad, there is a problem where bash does not provide a built-in to fix this. This can be particularly devious if the entire root directory is marked not executable. If the entire file system is not executable, you are looking at a live CD or a slave mounted drive.</p>
<p>There are a few options here roughly sorted by time to fix:</p>
<ul>
<li>Use a programming language like python, perl, or C to write your own chmod command to fix chmod</li>
<li>Use the linker directly by running <code>/lib/ld-*.so /bin/chmod 755 /bin/chmod</code> as root</li>
<li>Use a shell like busybox, zsh, or ksh that provides a built-in chmod</li>
<li>Reinstall chmod from repos or a working machine</li>
<li>Dump the bits of the binary and manually edit the permission bits</li>
<li>Use a live CD</li>
<li>Power off the machine, remove the hard drive, slave mount it to a different machine that has a working chroot, mount the drive, and fix it</li>
</ul>
<h4 id="chmod-examples">Chmod Examples</h4>
<h5 id="c">C</h5>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="pp">#include</span><span class="im">&lt;sys/stat.h&gt;</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[]) {
    chmod(<span class="st">&quot;/bin/chmod&quot;</span>, S_IRWXU);
    <span class="cf">return</span> <span class="dv">0</span>;
}</code></pre></div>
<h5 id="perl">Perl</h5>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="fu">perl</span> -e <span class="st">&#39;chmod 0755, &quot;/bin&quot;, &quot;/bin/chmod&quot;&#39;</span></code></pre></div>
<h5 id="python">Python</h5>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> os
os.chmod(<span class="st">&#39;/bin/chmod&#39;</span>, <span class="dv">0755</span>)</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="filesystem-layout-and-locations">Filesystem Layout and Locations</h1>
<h2 id="linux-filesystem-hierarchy">Linux Filesystem Hierarchy</h2>
<ul>
<li><code>/etc</code>
<ul>
<li>Should be backed up</li>
<li>Contains configuration files</li>
<li>Notable system files and directories
<ul>
<li><code>passwd</code> - user table</li>
<li><code>shadow</code> - password hash table</li>
<li><code>group</code> - group table</li>
<li><code>pam.d</code> - PAM configuration</li>
<li><code>sudoers</code> - sudo configuration</li>
<li><code>crontab</code> and <code>cron.*</code> - cron configuration</li>
</ul></li>
<li>Notable service files and directories
<ul>
<li><code>sshd</code> - OpenSSH</li>
<li><code>httpd</code> or <code>apache2</code> - Apache</li>
<li><code>nginx</code> - NGINX</li>
<li><code>named</code> or <code>bind</code> - BIND</li>
</ul></li>
</ul></li>
<li><code>/var</code>
<ul>
<li>Should be backed up</li>
<li>Contains changing permanent data (i.e. databases, logs, disk images, other service data)</li>
<li>Contains service home directories</li>
<li>Notable directories
<ul>
<li><code>db</code> - databases</li>
<li><code>lib</code> - service data</li>
<li><code>log</code> - logs</li>
<li><code>spool</code> - mail</li>
<li><code>www</code> - web server files</li>
<li><code>tmp</code> - temporary files that need to survive reboot</li>
</ul></li>
</ul></li>
<li><code>/tmp</code>
<ul>
<li>Temporary files that do not need to survive reboots</li>
<li>Sockets are often found here
<ul>
<li><code>.X11-unix</code> and <code>.ICE-unix</code> - places for X11 sockets and sessions (not found and should be deleted on a headless server!)</li>
</ul></li>
</ul></li>
<li><code>/home</code>
<ul>
<li>User data files</li>
</ul></li>
<li><code>/root</code>
<ul>
<li>Root user data files</li>
</ul></li>
<li><code>/bin</code>
<ul>
<li>Contains core executables for running the system (e.g. <code>init</code>, <code>cp</code>, <code>ls</code>, <code>rm</code>)</li>
</ul></li>
<li><code>/opt</code>
<ul>
<li>Contains special programs and services</li>
<li>Usually for locally compiled programs</li>
</ul></li>
<li><code>/usr</code>
<ul>
<li>Contains non-critical system programs</li>
<li>Has its own <code>bin</code>, <code>lib</code>, and <code>libexec</code></li>
<li>Notable directories
<ul>
<li><code>share</code> - place for static program files that do not go in <code>/etc</code> or <code>/var</code></li>
</ul></li>
</ul></li>
<li><code>/lib</code>
<ul>
<li>Core library files for running programs in <code>bin</code></li>
<li>Executables should not be here</li>
</ul></li>
<li><code>/libexec</code>
<ul>
<li>Library executables that should not be run as standalone programs</li>
<li>Scripts should probably not be here</li>
</ul></li>
<li><code>/proc</code>
<ul>
<li>Contains process information</li>
<li>Is not stored on the filesystem</li>
<li>Red teams often use this to find information about processes</li>
<li>A core system feature of Linux</li>
</ul></li>
<li><code>/dev</code>
<ul>
<li>Contains device files representing physical devices on the system</li>
<li>Red teams will go here to see if they can manipulate devices</li>
<li>A core system feature of Linux</li>
</ul></li>
<li><code>/sys</code>
<ul>
<li>Contains system interfaces to retrieve or change features of Linux or the underlying hardware</li>
<li>Red teams will likely not use this, but it can be used to get yourself out of a jam if system utilities are not working</li>
<li>A core system feature of Linux</li>
</ul></li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="dedicated-firewalls-system-firewalls-and-packet-filters">Dedicated Firewalls, System Firewalls, and Packet Filters</h1>
<h2 id="firewall-basics">Firewall Basics</h2>
<p>Firewalls are essentially sets of rules that allow network traffic in and out of a machine. In general, firewalls should be configured to allow the minimum required access. For Windows, the firewall is called Windows Firewall. For Linux, iptables is the built-in low-level firewall and ufw and firewalld are the most common high-level firewalls. For BSD, pf, the base of the pfSense enterprise firewall, is the default. For dedicated equipment, such as the Cisco ASA, custom firewalls or firewalls based on Linux and on occasion BSD are common.</p>
<p>In general, there are 3 major elements of firewall security:</p>
<ul>
<li>Use a default reject policy to avoid admitting unwanted traffic.</li>
<li>Open only the required ports to make the services to work.</li>
<li>Log any unusual traffic that hits the firewall.</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="firewalld">FirewallD</h2>
<h3 id="config-files">Config Files</h3>
<p>FirewallD references the following directories of files:</p>
<ul>
<li>'/usr/lib/firewalld' - where package default rules reside</li>
<li>'/etc/firewalld' - where user overrides rules reside</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands-1">Commands</h3>
<p>FirewallD uses only the <code>firewall-cmd</code> binary.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="filtering">Filtering</h3>
<p>FirewallD is the new Linux firewall from RedHat. It provides a usability layer on top of iptables by focusing on zones and services. FirewallD therefore inherits iptables's first match rule.</p>
<h4 id="zones">Zones</h4>
<p>Zones are affiliated with source addresses or interfaces. Zones have short names they are referenced by.</p>
<p>The following zone example affects all incoming traffic on the enp0s3 interface. It allows HTTPS traffic defined in the '/usr/lib/firewalld/services/https.xml' or overridden in '/etc/firewalld/services/https.xml'. It also blocks traffic on the 10.0.0.0/8 subnet by dropping and logging the packets.</p>
<div class="sourceCode"><pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;utf-8&quot;<span class="kw">?&gt;</span>
<span class="kw">&lt;zone&gt;</span>
    <span class="kw">&lt;short&gt;</span>Public<span class="kw">&lt;/public&gt;</span>
    <span class="kw">&lt;description&gt;</span>This is our external interface<span class="kw">&lt;/description&gt;</span>
    <span class="kw">&lt;interface</span><span class="ot"> name=</span><span class="st">&quot;enp0s3&quot;</span><span class="kw">/&gt;</span>
    <span class="kw">&lt;service</span><span class="ot"> name=</span><span class="st">&quot;https&quot;</span><span class="kw">/&gt;</span>
    <span class="kw">&lt;rule</span><span class="ot"> family=</span><span class="st">&quot;ipv4&quot;</span><span class="kw">&gt;</span>
        <span class="kw">&lt;source</span><span class="ot"> address=</span><span class="st">&quot;10.0.0.0/8&quot;</span><span class="kw">/&gt;</span>
        <span class="kw">&lt;log&gt;</span>
            <span class="kw">&lt;limit</span><span class="ot"> address=</span><span class="st">&quot;5/m&quot;</span><span class="kw">/&gt;</span>
        <span class="kw">&lt;/log&gt;</span>
        <span class="kw">&lt;drop/&gt;</span>
    <span class="kw">&lt;/rule&gt;</span>
<span class="kw">&lt;/zone&gt;</span></code></pre></div>
<h4 id="services">Services</h4>
<p>Services define the ports and protocols that will be used by an application. Services have short names they are referenced by.</p>
<p>The following service example allows traffic on TCP port 21. It uses a kernel module to help track and filter the traffic. This is not required for all modules, but is used for some services such as FTP.</p>
<div class="sourceCode"><pre class="sourceCode xml"><code class="sourceCode xml"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;utf-8&quot;<span class="kw">?&gt;</span>
<span class="kw">&lt;service&gt;</span>
    <span class="kw">&lt;short&gt;</span>FOO<span class="kw">&lt;/short&gt;</span>
    <span class="kw">&lt;description&gt;</span>Foo is a program that allows bar<span class="kw">&lt;/description&gt;</span>
    <span class="kw">&lt;port</span><span class="ot"> protocol=</span><span class="st">&quot;tcp&quot;</span><span class="ot"> port=</span><span class="st">&quot;21&quot;</span><span class="kw">/&gt;</span>
    <span class="kw">&lt;module</span><span class="ot"> name=</span><span class="st">&quot;nf_conntrack_foo&quot;</span><span class="kw">/&gt;</span>
<span class="kw">&lt;/service&gt;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration">Example Configuration</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="co"># get the name of the device used for the default route</span>
<span class="va">ext_if=$(</span><span class="ex">ip</span> route <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $5}&#39;</span><span class="va">)</span>

<span class="co"># list of devices that should be blocked on the external interface</span>
<span class="co"># WARNING! assumes that there are separate interfaces</span>
<span class="co">#          for the external network</span>
<span class="co"># NOTE the 192.168.0.0/16 subnet should be excluded</span>
<span class="co">#      if there is only one interface</span>
<span class="va">broken=</span><span class="st">&quot;224.0.0.22 127.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12, \</span>
<span class="st">        10.0.0.0/8, 169.254.0.0/16, 192.0.2.0/24, \</span>
<span class="st">        192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, \</span>
<span class="st">        169.254.0.0/16, 0.0.0.0/8, 240.0.0.0/4, 255.255.255.255/32&quot;</span>

<span class="ex">firewall-cmd</span> --zone=public --add-interface=<span class="va">$ext_if</span>

<span class="kw">for</span> <span class="ex">addr</span> in <span class="va">$broken</span><span class="kw">;</span> <span class="kw">do</span>
    <span class="ex">firewall-cmd</span> --zone=public \
        --add-rich-rule=<span class="st">&quot;rule family=&#39;ipv4&#39; service=ssh \</span>
<span class="st">        source address=</span><span class="dt">\&quot;</span><span class="va">$addr</span><span class="dt">\&quot;</span><span class="st"> log limit value=&#39;5/m&#39; drop&quot;</span>
    <span class="ex">firewall-cmd</span> --zone=public \
        --add-rich-rule=<span class="st">&quot;rule family=&#39;ipv4&#39; service=http \</span>
<span class="st">        source address=</span><span class="dt">\&quot;</span><span class="va">$addr</span><span class="dt">\&quot;</span><span class="st"> log limit value=&#39;5/m&#39; drop&quot;</span>
    <span class="ex">firewall-cmd</span> --zone=public \
        --add-rich-rule=<span class="st">&quot;rule family=&#39;ipv4&#39; service=https \</span>
<span class="st">        source address=</span><span class="dt">\&quot;</span><span class="va">$addr</span><span class="dt">\&quot;</span><span class="st"> log limit value=&#39;5/m&#39; drop&quot;</span>
<span class="kw">done</span>

<span class="ex">firewall-cmd</span> --zone=public --add-service=ssh
<span class="ex">firewall-cmd</span> --zone=public --add-service=http

<span class="ex">firewall-cmd</span> --direct --add-rule ipv4 filter INPUT_direct 0 \
    -p tcp --dport ssh -m state --state NEW -m recent --set
<span class="ex">firewall-cmd</span> --direct --add-rule ipv6 filter INPUT_direct 0 \
    -p tcp --dport ssh -m state --state NEW -m recent --set
<span class="ex">firewall-cmd</span> --direct --add-rule ipv4 filter INPUT_direct 1 \
    -p tcp --dport ssh -m state --state NEW -m recent --update \
    --seconds 30 --hitcount 6 -j REJECT --reject-with tcp-reset
<span class="ex">firewall-cmd</span> --direct --add-rule ipv6 filter INPUT_direct 1 \
    -p tcp --dport ssh -m state --state NEW -m recent --update \
    --seconds 30 --hitcount 6 -j REJECT --reject-with tcp-reset

<span class="ex">firewall-cmd</span> --runtime-to-permanent</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="iptables">iptables</h2>
<h3 id="config-files-1">Config Files</h3>
<p>iptables stores the majority of its configuration in a series of files:</p>
<ul>
<li>'/etc/sysconfig/iptables' - iptables configuration (RedHat-based distributions)</li>
<li>'/etc/iptables' - iptables configuration (Debian-based distributions)</li>
<li>'/etc/services' - an optional file that maps service names to port numbers</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands-2">Commands</h3>
<p>iptables uses the following binaries:</p>
<ul>
<li><code>iptables</code> - view and modify the firewall</li>
<li><code>iptables-save</code> - prints the running configuration to stdout; used to save the running configuration to a file</li>
<li><code>iptables-restore</code> - reads a file and sets the firewall configuration</li>
</ul>
<p>While a save format exists, iptables is normally configured via shell commands to avoid inconsistencies between save file versions.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="filtering-1">Filtering</h3>
<p>iptables will stop processing a packet when it matches the first rule. The only exception to this is the LOG target. When the LOG target is matched, matching will continue; but the traffic will be logged in the kernel log.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration-1">Example Configuration</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="co"># clear out the current configuration</span>
<span class="ex">iptables</span> -F <span class="kw">&amp;&amp;</span> <span class="ex">iptables</span> -X

<span class="co"># allow traffic on the loopback interface</span>
<span class="ex">iptables</span> -A INPUT -i lo -j ACCEPT

<span class="co"># ext_if is the device with the default route</span>
<span class="va">ext_if=$(</span><span class="ex">ip</span> route <span class="kw">|</span> <span class="fu">head</span> -n 1 <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $5}&#39;</span><span class="va">)</span>

<span class="co"># broken is a list of address that should be blocked on the external interface</span>
<span class="co"># WARNING! Assumes that there is an internal and an external interface</span>
<span class="co"># note that 192.168.0.0/16 should not be blocked if there is only one interface</span>
<span class="va">broken=</span><span class="st">&quot;224.0.0.22 127.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12, \</span>
<span class="st">        10.0.0.0/8, 169.254.0.0/16, 192.0.2.0/24, \</span>
<span class="st">        192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, \</span>
<span class="st">        169.254.0.0/16, 0.0.0.0/8, 240.0.0.0/4, 255.255.255.255/32&quot;</span>


<span class="co"># use a default drop policy</span>
<span class="ex">iptables</span> -P INPUT DROP

<span class="co"># disable all ipv6 traffic; Syntax is the same as ipv4 if required</span>
<span class="ex">ip6tables</span> -P INPUT DROP
<span class="ex">ip6tables</span> -P OUTPUT DROP
<span class="ex">ip6tables</span> -P FORWARD DROP

<span class="co"># log traffic that is dropped by the firewall</span>
<span class="ex">iptables</span> -N LOGDROP
<span class="ex">iptables</span> -A LOGDROP -m log --log-level info --log-prefix <span class="st">&quot;IPTABLES&quot;</span> \
    -m limit --limit 5/m --limit-burst 10 -j LOG
<span class="ex">iptables</span> -A LOGDROP -j DROP

<span class="co"># block bad packets and http and ssh traffic from broken addresses</span>
<span class="ex">iptables</span> -A INPUT -m conntrack --ctstate INVALID -j LOGDROP
<span class="ex">iptables</span> -t raw -I PREROUTING -m rpfilter -j LOGDROP
<span class="kw">for</span> <span class="ex">addr</span> in <span class="va">$broken</span><span class="kw">;</span> <span class="kw">do</span>
    <span class="ex">iptables</span> -A INPUT -p tcp -i <span class="va">$ext_if</span> -s <span class="va">$addr</span> --dport 80 -j REJECT
    <span class="ex">iptables</span> -A INPUT -p tcp -i <span class="va">$ext_if</span> -s <span class="va">$addr</span> --dport 443 -j REJECT
    <span class="ex">iptables</span> -A INPUT -p tcp -i <span class="va">$ext_if</span> -s <span class="va">$addr</span> --dport 22 -j REJECT
<span class="kw">done</span>

<span class="co"># allow established traffic to applications</span>
<span class="ex">iptables</span> -I INPUT 1 -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

<span class="co"># allow new traffic to applications</span>
<span class="ex">iptables</span> -A INPUT -m limit --limit 5/m --limit-burst 10 -m conntrack \
    --ctstate NEW -p tcp --dport 22 -j ACCEPT
<span class="ex">iptables</span> -A INPUT -m limit --limit 5/m --limit-burst 10 -m conntrack \
    --ctstate NEW -p tcp --dport 80 -j ACCEPT
<span class="ex">iptables</span> -A INPUT -m limit --limit 5/m --limit-burst 10 -m conntrack \
    --ctstate NEW -p tcp --dport 443 -j ACCEPT

<span class="co"># drop all other traffic</span>
<span class="ex">iptables</span> -A INPUT -j DROP</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="palo-alto">Palo Alto</h2>
<p>The Palo Alto firewall is a common and relatively user friendly hardware firewall solution.</p>
<h3 id="lights-out">Lights Out</h3>
<p>To disconnect a port, likely for the purposes of isolating the network from attack, use the following snippet with the desired interface to disconnect.</p>
<pre class="paloalto"><code>configure
set network interface ethernet &lt;interface&gt; link-state down
commit</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="basic-commands">Basic Commands</h3>
<p>The Palo Alto firewall works similar to Cisco systems in that the command line has various contexts it can be in. The default context gives access to basic network tools, such as ping or traceroute. To configure the firewall, use the <code>configure</code> context. While in the <code>configure</code> context, you can open various <code>edit</code> contexts that follow the hierarchical nature of the firewall configuration. For each <code>edit</code> context, it scopes the <code>set</code> command to those contexts so that the full path does not need to be specific for several set statements in a row. The <code>up</code> and <code>top</code> commands can travel up the hierarchy back to base contexts. Settings are not live until the <code>commit</code> command is run. You can use tab completion or the question mark key to complete written values and find potential options. The sections below will assume you are in the appropriate <code>edit</code> context given at the beginning of the section.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="rules">Rules</h3>
<p>To edit security rules, such as traffic barriers between interfaces, enter the <code>edit rulebase security</code> context. Rules between zones are default deny and rules within zones are default allow.</p>
<h4 id="firewall-connections">Firewall Connections</h4>
<p>The following rule prevents any connections to the firewall itself.</p>
<pre class="paloalto"><code>edit rules banhammer
set from any destination &lt;firewall address&gt; action deny
up</code></pre>
<h4 id="dmz-and-lan-interaction">DMZ and LAN Interaction</h4>
<p>The following rule enables a connection between the DMZ and LAN under specific circumstances, here a MySQL connection from webapps to database.</p>
<pre class="paloalto"><code>edit rules database
set from dmz to lan source &lt;webapps&gt; destination &lt;database&gt; application mysql action allow
up</code></pre>
<h4 id="outgoing-traffic">Outgoing Traffic</h4>
<p>The following rule enables outgoing communication to specific websites for package management and for DNS lookups.</p>
<pre class="paloalto"><code>edit rules package
set from any to public destination [ &lt;centos archive&gt; &lt;debian archive&gt; ] application web-browsing
up
edit rules dns
set from any to public destination &lt;dns server&gt; application dns
up</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="pf">pf</h2>
<h3 id="config-files-2">Config Files</h3>
<p>pf references the following files:</p>
<ul>
<li>'/etc/rc.conf' - as with all servies, pf must be enabled here</li>
<li>'/etc/pf.conf' - pf configuration file</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands-3">Commands</h3>
<p>pf uses the following binaries:</p>
<ul>
<li><code>pfctl -f /etc/pf.conf</code> - load the firewall configuration</li>
<li><code>pfctl -sa</code> - see the current configuration status</li>
<li><code>kldload pf</code> - load the pf kernel module</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="filtering-2">Filtering</h3>
<p>All of the configuration for pf is stored in '/etc/pf.conf'. There is no way to modify the running configuration except to overwrite the running configuration with the saved configuration. Unlike other firewalls, the last rule to match will be the rule that is applied. This behavior can be overridden by using the <code>quick</code> keyword.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration-2">Example Configuration</h3>
<pre class="pf"><code># adapted from bsdnow tutorial

# variables for convenience
ext_if = &quot;em0&quot;
broken=&quot;224.0.0.22 127.0.0.0/8, 192.168.0.0/16, 172.16.0.0/12, \
        10.0.0.0/8, 169.254.0.0/16, 192.0.2.0/24, \
        192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, \
        169.254.0.0/16, 0.0.0.0/8, 240.0.0.0/4, 255.255.255.255/32&quot;
# use a default drop policy
set block-policy drop

# skip the local loopback interface
set skip on lo0

# block invalid packets
match in all scrub (no-df max-mss 1440)
block in all
pass out quick on $ext_if inet keep state
antispoof quick for ($ext_if) inet

# block ipv6 if it is not needed
block out quick inet6 all
block in quick inet6 all

# block any packet we can&#39;t find a valid route back to
block in quick from { $broken urpf-failed no-route } to any
block out quick on $ext_if from any to { $broken no-route }

# block bad actors
table &lt;childrens&gt; persist
block in log quick proto tcp from &lt;childrens&gt; to any

# block Chinese address to ssh and web
table &lt;chuugoku&gt; persist file &quot;/etc/cn.zone&quot;
block in quick proto tcp from &lt;chuugoku&gt; to any port { 80 22 }

# allow traffic thought the firewall
pass in on $ext_if proto tcp from any to any port 80 flags S/SA synproxy state
pass in on $ext_if proto tcp from 1.2.3.4 to any port { 137, 139, 445, 138 }
pass in on $ext_if proto tcp to any port ssh flags S/SA keep state \
(max-src-conn 5, max-src-conn-rate 5/5, overload &lt;childrens&gt; flush)
pass inet proto icmp icmp-type echoreq

# adapted from the http://www.bsdnow.tv/tutorials/pf
# which is distrusted under CC-BY-SA</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="uncomplicated-firewall">Uncomplicated Firewall</h2>
<h3 id="config-files-3">Config Files</h3>
<p>Uncomplicated Firewall references mainly the following files:</p>
<ul>
<li>'/etc/default/ufw' - high level configuration</li>
<li>'/etc/ufw/sysctl.conf' - kernel tunables</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands-4">Commands</h3>
<ul>
<li>ufw enable - enables and reloads the firewall</li>
<li>ufw default - sets default action</li>
<li>ufw allow - allows service or port</li>
<li>ufw deny - blocks a service or port</li>
<li>ufw limit - allows with connection rate limiting</li>
<li>ufw status verbose - display the current firewall rules (if active)</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="sample-usage">Sample Usage</h3>
<ul>
<li>ufw allow 8080/tcp - adds a rule that allows incoming traffic on tcp port 22</li>
<li>ufw delete allow 8080/tcp - deletes the previous rule</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="filtering-3">Filtering</h3>
<p>Uncomplicated Firewall is based on iptables and therefore inherits iptables's first match rule.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration-3">Example Configuration</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="ex">ufw</span> default deny
<span class="ex">ufw</span> allow ssh/tcp
<span class="ex">ufw</span> logging on
<span class="ex">ufw</span> enable</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="logging-investigation-and-auditing">Logging, Investigation, and Auditing</h1>
<h2 id="auditd">auditd</h2>
<p>Linux has a built-in auditing framework that acts in kernel space. This portion of the kernel communicates with the userspace auditd server. It can be configured to monitor files and syscalls.</p>
<h3 id="installation-1">Installation</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="ex">dnf</span> install audit
<span class="ex">systemctl</span> start auditd</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="config-files-4">Config Files</h3>
<p>The userspace auditing commands, can be used to configure logs. Audit can stores its rules in '/etc/audit/audit.rules' or in files inside '/etc/audit/audit.d/'. The syntax for these files is the same as the userspace commands.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="commands-5">Commands</h3>
<p>Viewing the auditlog can be done in a few ways:</p>
<ul>
<li><code>aureport</code> - query logs for a specific event</li>
<li><code>ausearch</code> - view a summary of recent events</li>
<li><code>syslog</code> - view logs typically stored in '/var/log/audit/audit.log'</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration-4">Example Configuration</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># remove all rules</span>
<span class="ex">auditctl</span> -D

<span class="co"># see a list of rules</span>
<span class="ex">auditctl</span> -l

<span class="co"># watch a file for writes</span>
<span class="ex">auditctl</span> -w /etc/passwd -p wa -k passwd_access

<span class="co"># watch a directory and all its children for writes</span>
<span class="ex">auditctl</span> -w /etc/ -p wa -k etc_writes

<span class="co"># watch for use of a specific syscalls</span>
<span class="ex">auditctl</span> -a always,exit -S stime.* -k time_changes
<span class="ex">auditctl</span> -a always,exit -S setrlimit.* -k setrlimits
<span class="ex">auditctl</span> -a always,exit -S unlink -S rmdir -k deleting_files

<span class="co"># watch for unsucessful calls</span>
<span class="co"># the -F flag filters out based on various</span>
<span class="co"># options see man auditctl for more details</span>
<span class="ex">auditctl</span> -a always,exit -S all -F sucess=0

<span class="co"># make the default audit log buffer larger</span>
<span class="ex">auditctl</span> -b 1024

<span class="co"># lock audit rules so that they cannot be edited until reboot</span>
<span class="ex">auditctl</span> -e 2</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="rsyslog">Rsyslog</h2>
<p>Rsyslog is a client and server that conforms to the syslog protocol. On systems with systemd (i.e. RedHat and newer Debian distributions), journald is typically used instead, but both programs can be used to compliment each other.</p>
<h3 id="config-files-5">Config Files</h3>
<p>Rsyslog is generally configured by '/etc/syslog.conf' and '/etc/syslog.conf.d/' like most other syslog daemons.</p>
<h4 id="etcsyslog.conf">/etc/syslog.conf</h4>
<pre class="syslog"><code>*.err;kern.debug                        /dev/console
auth.notice;authpriv.none               /dev/console
*.err;*.crit;*.emerg                    /var/log/critical.log
*.notice                                /var/log/messages
auth,authpriv.none                      /var/log/messages
auth,authpriv.debug                     /var/log/auth.log
cron.info                               /var/log/cron.log
news,kern,lpr,daemon,ftp,mail.info      /var/log/daemon.log
*.err;user.none                         root
*.emerg;user.none                       *</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="script">Script</h2>
<p>The <code>script</code> command can be used to record commands run for audit logs.</p>
<h3 id="usage">Usage</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># use default interactive interpreter</span>
<span class="ex">script</span> <span class="op">&lt;</span>file<span class="op">&gt;</span>

<span class="co"># use specified interactive interpreter</span>
<span class="ex">script</span> -c bash <span class="op">&lt;</span>file<span class="op">&gt;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="operating-system-utilities">Operating System Utilities</h1>
<h2 id="advanced-packaging-tool-apt">Advanced Packaging Tool (apt)</h2>
<h3 id="archive-mirrors">Archive Mirrors</h3>
<p>If you are running a particularly old version of Debian, you should set up the archive mirrors to get a working package manager.</p>
<h4 id="etcaptsources.list">/etc/apt/sources.list</h4>
<pre class="apt"><code>deb http://archive.debian.org/debian/ [version]/main
deb http://archive.debian.org/debian-security/ [version]/updates
deb http://archive.debian.org/debian-volatile/ [version]/volatile</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="sh">sh</h2>
<h3 id="backgrounding">Backgrounding</h3>
<p>Often you will want to be able to run processes in the background during the contest. There are a few ways to do this:</p>
<ul>
<li>job control - this is the legacy job control system.</li>
<li>tmux/screen - if they are installed, these are more full featured tools</li>
</ul>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># run an update with yum in the background writing the log to</span>
<span class="co"># &#39;/var/log/yum_updates&#39; that will continue running even if the user logs out</span>
<span class="fu">nohup</span> yum update -y <span class="op">&gt;&gt;</span>/var/log/yum_updates <span class="op">2&gt;&amp;1</span> <span class="kw">&amp;</span>

<span class="co"># see the running list of jobs</span>
<span class="bu">jobs</span> -l

<span class="co"># send a job to the background</span>
<span class="bu">bg</span>

<span class="co"># send a job to the foreground</span>
<span class="bu">fg</span>

<span class="co"># disown a process after you start it</span>
<span class="bu">disown</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="scripting">Scripting</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># for loop that outputs 1 2 3 4 5 6 7 8 9 10 a b c</span>
<span class="kw">for</span> <span class="ex">i</span> in <span class="dt">{1..10}</span> a b c
<span class="kw">do</span>
    <span class="bu">echo</span> <span class="va">$i</span>
<span class="kw">done</span>

<span class="co"># conditional testing for an empty string</span>
<span class="va">foo=</span><span class="st">&quot;bar&quot;</span>
<span class="kw">if</span><span class="bu"> [</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$foo</span><span class="st">&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="va">$foo</span>
<span class="kw">fi</span>

<span class="co"># conditional testing equal stings</span>
<span class="kw">if</span><span class="bu"> [</span> <span class="st">&quot;</span><span class="va">$foo</span><span class="st">&quot;</span> <span class="ot">==</span> <span class="st">&quot;bar&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="va">$foo</span>
<span class="kw">fi</span>

<span class="co"># conditional testing numeric values</span>
<span class="kw">if</span><span class="bu"> [</span> 1 <span class="ot">-eq</span> 2<span class="bu"> ]</span>; <span class="kw">then</span>
    <span class="bu">echo</span> <span class="va">$foo</span>
<span class="kw">fi</span>

<span class="co"># example function</span>
<span class="fu">foobar()</span><span class="kw">{</span>
    <span class="bu">echo</span> <span class="va">$1</span>
<span class="kw">}</span>
<span class="ex">foobar</span> <span class="st">&quot;this echos this statement&quot;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="filesystem-and-access-control-permissions">Filesystem and Access Control Permissions</h1>
<h2 id="dev">/dev</h2>
<p>The following command will fix permissions for all device files to reasonable defaults:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># find devices with execute permissions and remove the execute permissions</span>
<span class="fu">find</span> /dev <span class="dt">\(</span> -type c -or -type b -or -type f <span class="dt">\)</span> -perm -+x -exec chmod -x <span class="dt">{}</span> <span class="dt">\;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="home">/home</h2>
<p>The following command will fix permissions for all home files to reasonable defaults:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># barring unusual circumstances, files in a home directory should be 640</span>
<span class="fu">sed</span> -i -e <span class="st">&quot;s/^umask [0-9][0-9][0-9]$/umask 027/&quot;</span> /etc/profile
<span class="kw">for</span> <span class="fu">file</span> in <span class="va">$(</span><span class="fu">find</span> /home/*<span class="va">)</span><span class="kw">;</span> <span class="kw">do</span>
    <span class="kw">if</span><span class="bu"> [</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
        <span class="co">#Directories must have execute permissions</span>
        <span class="fu">chmod</span> 750 <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>
    <span class="kw">elif</span><span class="bu"> [</span> <span class="ot">-x</span> <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
        <span class="co">#Some users will have scripts in there home directory</span>
        <span class="bu">read</span> <span class="st">&quot;Should this file be executable (</span><span class="va">$file</span><span class="st">) ?&quot;</span> <span class="va">yes</span>
        <span class="kw">if</span><span class="bu"> [</span> <span class="va">$yes</span> <span class="ot">-eq</span> <span class="st">&quot;y&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
            <span class="fu">chmod</span> 750 <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>
        <span class="kw">else</span>
            <span class="fu">chmod</span> 640 <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>
        <span class="kw">fi</span>
    <span class="kw">else</span>
        <span class="co">#If it is not a file or directory, mark it 640</span>
        <span class="fu">chmod</span> 640 <span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>
    <span class="kw">fi</span>
<span class="kw">done</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="varwww">/var/www</h2>
<p>The following command will fix permissions for all www files to reasonable defaults:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="fu">find</span> /var/www -type d -exec chmod 750 <span class="dt">{}</span> <span class="dt">\;</span>
<span class="fu">find</span> /var/www -type f -exec chmod 640 <span class="dt">{}</span> <span class="dt">\;</span>
<span class="fu">chown</span> -R root:apache /var/www
<span class="fu">chmod</span> 770 /var/www/[any directories that need to be writable by the web application]</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="provisioners">Provisioners</h1>
<h2 id="ansible">Ansible</h2>
<p>Ansible is a lightweight agent-less provisioner that uses Python 2.x and OpenSSH as a backend. It is configured using Playbooks which are files written in a dialect of YAML.</p>
<h3 id="setting-it-up">Setting it Up</h3>
<h4 id="managed-windows-machines">Managed Windows Machines</h4>
<p>Ansible can also manage Windows machines running PowerShell 3.0 or later. For windows machines, you will also need to create an encrypted <code>host_vars</code> or <code>group_vars</code> file on the control machine that contains the following information:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="co"># run &#39;ansible-vault edit group_vars/windows.yml&#39;</span>
<span class="co"># be sure to specifiy --ask-vault-pass when running ansible</span>

<span class="co"># Will use AD if user name is like username@realm and you are signed into kerberos</span>
<span class="co"># If you are using Ansible 1.x, the ansible_{user,pass,port} were called</span>
<span class="co"># ansible_ssh_{user,pass,port}</span>
<span class="fu">ansible_user:</span> WindowsAdministratorUsername
<span class="fu">ansible_pass:</span> WindowsAdministratorPassword
<span class="fu">ansible_port:</span> 5986
<span class="fu">ansible_connection:</span> winrm</code></pre></div>
<p>It is also required to run the 'ConfigureRemotingForAnsible.ps1' from the Ansible source code script on the Windows machines that will be managed.</p>
<h4 id="managed-linux-machines">Managed Linux Machines</h4>
<p>Ansible is agent-less, this means that only one machine must have Ansible installed on it. For Linux or BSD managed machines, all you have to have is OpenSSH and Python 2.x. For some Linux distributions where Python 3.x is the default or python is installed in an non-standard location, you may need to set <code>ansible_python_interpetor = /usr/bin/python2</code>. For best performance, SFTP must be enabled in '/etc/ssh/sshd_config' as a subsystem with the path to the 'sftp-server' binary</p>
<h4 id="control-machine">Control Machine</h4>
<p>The control machine must have a few more pieces of software. On most distributions, it can be installed from package repositories. It can also be installed from source:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># Install the source</span>
<span class="fu">git</span> clone git://github.com/ansible/ansible.git --recursive
<span class="bu">cd</span> ./ansible
<span class="bu">source</span> ./hacking/env-setup

<span class="co"># For really broken machines such as Metaspoitable, install python27 from source</span>
<span class="co"># You may even have to disable certificate checking (-k) but don&#39;t do that if you</span>
<span class="co"># don&#39;t have to;  You will also need to set ansible_python_interpertor for these machines</span>
<span class="ex">curl</span> -LO https://www.python.org/ftp/python/2.7/Python-2.7.tgz
<span class="fu">tar</span> -xzvf ./Python-2.7.tgz
<span class="bu">cd</span> ./Python-2.7
<span class="ex">./configure</span> <span class="kw">&amp;&amp;</span> <span class="fu">make</span> <span class="kw">&amp;&amp;</span> <span class="fu">make</span> install

<span class="co">#For CentOS</span>
<span class="fu">sudo</span> yum install epel-release
<span class="fu">sudo</span> yum install autoconf gcc python-devel

<span class="co"># or install from pip</span>
<span class="fu">sudo</span> pip install ansible

<span class="co"># Install dependencies if installing Ansible from github</span>
<span class="fu">sudo</span> pip install paramiko PyYAML Jinja2 httplib2 six

<span class="co"># To manage Windows machines</span>
<span class="ex">pip</span> install https://github.com/diyan/pywinrm/archive/master.zip#egg=pywinrm
<span class="ex">pip</span> install kerberos</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="inventory-management">Inventory Management</h3>
<p>The collections of machines that are managed via Ansible are called the inventory. Here is an example inventory file:</p>
<pre class="ansible"><code>[web:children]
webservers
databases

[webservers]
192.168.0.2
192.168.0.[10:20]

[databases]
foo.bar.com
sue.bar.com

[secureservers]
foobar@10.0.0.2:23

[local]
localhost ansible_connection=local</code></pre>
<p>In this example we demonstrate,</p>
<ul>
<li>A set of hosts specified by a range of ip addresses</li>
<li>A set of hosts specified by domain name</li>
<li>A host using a different user and default port.</li>
<li>Targeting the localhost</li>
<li>Four groups of hosts called web, webservers, databases, and local</li>
<li>A group of groups called web that contains all the hosts in webservers and databases.</li>
</ul>
<p>NOTE, group variables and host variables can also be specified in the hosts file as shown with the <code>ansible_connection</code> example, but this format is discouraged because it does not follow a separation of concerns.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="sample-playbooks">Sample Playbooks</h3>
<p>Repositories containing Ansible playbooks are generally arranged out as follows:</p>
<ul>
<li>'site.yml' - the primary playbook</li>
<li>'hosts' - the primary host inventory</li>
<li>'group_vars/' - directory containing encrypted group variables</li>
<li>'host_vars/' - directory containing encrypted host variables</li>
<li>'roles/' - directory containing roles that will be applied</li>
</ul>
<p>Here is an example playbook:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="ot">---</span>
<span class="kw">-</span> <span class="fu">host:</span> webservers <span class="co"># run this on the webserver group</span>
  <span class="fu">become:</span> yes <span class="co"># escalate this play from remote user to super user</span>
              <span class="co"># A user can also be specified via &quot;become_user:&quot;</span>

  <span class="co"># varibles needed in the httpd.conf template</span>
  <span class="fu">vars:</span>
    <span class="fu">http_port:</span> 80
    <span class="fu">max_clients:</span> 200

  <span class="co"># tasks that will be run run on the server</span>
  <span class="fu">tasks:</span>

    <span class="co"># demonstrates iteration</span>
    <span class="kw">-</span> <span class="fu">name:</span> create admins
      <span class="fu">user:</span> name={{item.name}} shell={{item.shell}} groups=wheel append=yes
      <span class="fu">with_items:</span>
          <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span> <span class="st">&#39;matthew&#39;</span><span class="kw">, </span><span class="fu">shell:</span> <span class="st">&#39;/bin/bash&#39;</span><span class="kw">}</span>
          <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span> <span class="st">&#39;mark&#39;</span><span class="kw">, </span><span class="fu">shell:</span> <span class="st">&#39;/bin/zsh&#39;</span><span class="kw">}</span>
          <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span> <span class="st">&#39;luke&#39;</span><span class="kw">, </span><span class="fu">shell:</span><span class="st">&#39;/bin/fish&#39;</span><span class="kw">}</span>

    <span class="co"># demonstrates conditionals</span>
    <span class="kw">-</span> <span class="fu">name:</span> install apache for CentOS
      <span class="fu">yum:</span> name=httpd state=latest
      <span class="fu">when:</span> ansible_distribution == &#39;CentOS&#39;

    <span class="kw">-</span> <span class="fu">name:</span> install apache for Debian
      <span class="fu">apt:</span> name=lighttpd state=latest
      <span class="fu">when:</span> ansible_os_family == &#39;Debian&#39;

    <span class="co"># demonstrates handlers and templates</span>
    <span class="kw">-</span> <span class="fu">name:</span> update the apache config file
      <span class="fu">template:</span> src=httpd.j2 dest=/etc/httpd.conf
      <span class="fu">notify:</span>
        <span class="kw">-</span> restart apache

    <span class="co"># demonstrates starting a service</span>
    <span class="kw">-</span> <span class="fu">name:</span> ensure apache is running
      <span class="fu">service:</span> name=httpd state=started enabled=yes

  <span class="co"># tasks that need to be run when other tasks are run</span>
  <span class="fu">handlers:</span>
      <span class="kw">-</span> <span class="fu">name:</span> restart apache
        <span class="fu">service:</span> name=httpd state=restarted</code></pre></div>
<p>These playbooks can also be split into separate sections in what are called roles. Here is how a sample role, in this case a webserver are stored:</p>
<ul>
<li>'roles/webserver' - directory where the webserver role is stored.</li>
<li>'roles/webserver/files' - files that would be referenced via copy commands in the role.</li>
<li>'roles/webserver/tempates' - templates that would be referenced via template commands in the role.</li>
<li>'roles/webserver/tasks' - where tasks for the webserver role are stored.</li>
<li>'roles/webserver/handlers' - where handlers that kickoff post processing tasks for the webserver role are stored.</li>
<li>'roles/webserver/vars' - where role specific variables for the webserver role are stored.</li>
<li>'roles/webserver/defaults' - where role specific default values variables for the webserver role are stored.</li>
<li>'roles/webserver/meta' - where role specific meta data for the webserver role are stored such as dependencies could be listed.</li>
</ul>
<h4 id="ansible-vault">Ansible Vault</h4>
<p>Ansible has a means of creating AES encrypted files for use of storing configuration. To create a file use <code>ansible-vault create &lt;filename&gt;</code> To edit a file use <code>ansible-vault edit &lt;filename&gt;</code> which will open the file un-encrypted in the user's <code>EDITOR</code> and re-encrypt it after editing. It can be used for file containing variables and files that are part of roles.</p>
<h4 id="extending-ansible">Extending Ansible</h4>
<p>Somethings Ansible is just not good at, string parsing for instance. You can write modules in Python that do this heavy lifting. Here is a sample module that checks for the sshd version, and sets a variable with the output:</p>
<pre class="python2"><code>&quot;&quot;&quot;
Fundamentally, ansible modules simply accept a JSON string as input, do work,
and return a JSON string as output to stdout.  At no time should anything be
printed that is not the final JSON output, or exceptions be returned
This if this module was called site_facts can be included via a play like so:
---
- name: Gather facts
  action: site_facts
  tags:
    - always
&quot;&quot;&quot;
import re
import functools

def ssh_facts(module):
    &quot;&quot;&quot;
    Collect facts for the ssh installations
    &quot;&quot;&quot;
    #Prior to Python 3, there was not a good subprocess module
    #So ansible includes their own with the necessary options set
    rc, out, err = module.run_command(args=[&#39;ssh&#39;, &#39;-V&#39;])
    if rc == 0:
        ssh_version = str(err).split(&#39;,&#39;)[0]
        ssh_version = ssh_version[8:]
    else:
        ssh_version = &#39;0.0p0&#39;

    try:
        major_version, minor_version, patch_version = \
                re.match(r&#39;(\d+)\.(\d+)p(\d+)&#39;, ssh_version).groups()
    except AttributeError:
        ssh_version = &#39;0.0p0&#39;
        major_version, minor_version, patch_version = (0, 0, 0)

    return {
        &quot;ssh_version&quot;: ssh_version,
        &quot;ssh_major_version&quot;: major_version,
        &quot;ssh_minor_version&quot;: minor_version,
        &quot;ssh_patch_version&quot;: patch_version,
    }

FACTS = {
    &quot;ssh&quot;: ssh_facts,
}

def main():
    &quot;&quot;&quot;
    This is the main method, to extend this module, add an entry to FACTS
    and write a function that gathers the necessary information
    &quot;&quot;&quot;

    #Here are where the arguments to the module are examined
    #The quotes around str are important
    module = AnsibleModule(argument_spec=dict(
        name=dict(type=&#39;str&#39;, default=&#39;*&#39;),
    ))

    name = module.params[&#39;name&#39;]
    results = []

    if name == &quot;*&quot;:
        results = [FACTS[fact](module) for fact in FACTS]
    else:
        results = [FACTS[name](module)]

    #Unify the dictionaries returned from each command into a single dictionary
    facts = dict(functools.reduce(set.union, map(set, map(dict.items, results))))

    module.exit_json(changed=False, ansible_facts=facts)

from ansible.module_utils.basic import *
if __name__ == &#39;__main__&#39;:
    main()</code></pre>
<h4 id="documentation">Documentation</h4>
<p>For each of the ansible modules, there is documentation that is installed. It can be viewed using the <code>ansible-doc</code> command. Use <code>ansible-doc -l</code> to get a list of all the available modules and a short description.</p>
<p>Ansible uses Jinja2 for Templates. To access the list of filters as well as extensive examples, run <code>pydoc jinja2.filters</code>. These templates can also be used for variables, see <code>ansible all -m setup</code> for a list of available facts.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="scripts-and-other-useful-snippets">Scripts and Other Useful Snippets</h1>
<h2 id="add-group">Add Group</h2>
<p>The following scripts takes an accounts.csv file with headers 'Firstname,Lastname,SAM,Email' and adds them to the current Active Directory 'Administrators' group.</p>
<pre class="powershell"><code>$Users = Import-Csv -Path &quot;accounts.csv&quot;

ForEach($user in $Users){
    Add-ADGroupMember -Identity Administrators -Member $user.SAM
}</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="bulk-users">Bulk Users</h2>
<p>The following scripts takes an accounts.csv file with headers 'Firstname,Lastname,SAM,Email' and adds them to the current Active Directory.</p>
<pre class="powershell"><code>$Users = Import-Csv -Path &quot;accounts.csv&quot;
foreach ($User in $Users)
{
    $Displayname = $User.Firstname + &quot; &quot; + $User.Lastname
    $UserFirstname = $User.Firstname
    $UserLastname = $User.Lastname
    $SAM = $User.SAM
    $UPN = $User.Email
    $Password = &quot;CUCyber9.&quot;
    New-ADUser -Name &quot;$Displayname&quot; -DisplayName &quot;$Displayname&quot; `
        -GivenName &quot;$UserFirstname&quot; -Surname &quot;$UserLastname&quot; -SamAccountName $SAM `
        -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Enabled $true -ChangePasswordAtLogon $true
}</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="parallel">Parallel</h2>
<p>The following script takes in a file then command parameter in and for every server in the file, it runs the command on that server.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="va">file=</span><span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span>
<span class="va">cmd=</span><span class="st">&quot;</span><span class="va">${*:2}</span><span class="st">&quot;</span>
<span class="kw">while</span> <span class="bu">read</span> <span class="va">server</span>; <span class="kw">do</span>
  <span class="kw">(</span><span class="fu">ssh</span> <span class="va">$server</span> <span class="va">$cmd</span><span class="kw">)</span> <span class="kw">&amp;</span>
<span class="kw">done</span> <span class="op">&lt;</span><span class="st">&quot;</span><span class="va">$file</span><span class="st">&quot;</span>
<span class="bu">wait</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="system-services-and-network-applications">System Services and Network Applications</h1>
<h2 id="apache">Apache</h2>
<p>Apache is a one of the most popular web servers with a large variety of features.</p>
<h3 id="installation-2">Installation</h3>
<p>There is a large variety of steps that are important for securing Apache.</p>
<ul>
<li>Install Mod Security either from repos or from www.modsecurity.org</li>
<li>Configure the Apache to use the Mod Security core rules from the repos or www.modsecurity.org</li>
<li>Remove unnecessary options and text from Apache's httpd.conf file and '/etc/httpd/conf.d' (sometimes located at '/etc/apache2/conf/extra')</li>
<li>Remove all unnessisary modules entries from Apache's httpd.conf file</li>
<li>Create an Apache user and group without a shell</li>
<li>Configure Apache to run using this user and group</li>
<li>Restrict access to the webserver via the Order allow,deny line in httpd.conf</li>
<li>Prevent access to root file system</li>
<li>Allow only read access to web directory '/var/www/html'</li>
<li>Disable the following functionality if possible:
<ul>
<li>ExecCGI - Allow scripts to be run by apache from this directory.</li>
<li>FollowSymLinks - allow the server to follow symlinks</li>
<li>SymLinksIfOwnerMatch - has large performance costs.</li>
<li>Includes - permists the execution of server side includes</li>
<li>IncludesNOEXEC - same as above except prohibit executing scripts</li>
<li>Indexes - create an a directory listing in directories without an index.html</li>
<li>AllowOverride - allows overrides in '.htaccess' files</li>
<li>Multiviews - allows for the same request to ask for multiple files.</li>
</ul></li>
<li>Use RewriteEngine, RewriteCond, and RewriteRule to force HTTP 1.1</li>
<li>Configure the web server to only server allowed file types.</li>
<li>Configure to protect from DoS attacks
<ul>
<li>Timeout - set this to a low value like 10 seconds</li>
<li>KeepAlive - set this to on (unless RAM is a problem)</li>
<li>KeepAliveTimeout - set to 15</li>
<li>AcceptFilter http data - require content to open connection</li>
<li>AcceptFilter https data - require content to open connection</li>
</ul></li>
<li>Configure to protect against Buffer Overflows
<ul>
<li>LimitRequestBody 64000 - Limit requests to 10k in size</li>
<li>LimitRequestFeilds 32 - Limit number of request fields</li>
<li>LimitRequestFeildSize 8000 - Limit size of request lines</li>
<li>LimitRequestLine 4000 - Maximum size of the request line</li>
</ul></li>
<li>Use Mod_SSL if possible (see OpenSSL section for generating a sever certificate)</li>
<li>Set ServerTokens to ProductOnly</li>
<li>Use custom error pages via the ErrorDocument directive</li>
<li>Remove default files and cgi-scripts</li>
<li>Do not keep Apache Source after installation</li>
<li>Ensure that web sever binaries are owned by root</li>
<li>Allow only root to read the apache config or logs '/usr/lib/apache/{conf,logs}'</li>
<li>Move apache to a chroot if possible - see below</li>
<li>Use Mod_Log_Forensic</li>
<li>Remove compromising or information leaking modules
<ul>
<li>mod_status</li>
<li>mod_info</li>
<li>mod_autoindex</li>
<li>mod_cgi</li>
</ul></li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="remove-override-functionality">Remove Override Functionality</h3>
<p>Web application override functionality should be disabled as they are a major security flaw in the Apache system. The functionality is easy to disable, <code>AllowOverride None</code> everywhere it is referenced, but the '.htaccess' files should be merged into a global configuration file. This can be done using the following snippet.</p>
<div class="sourceCode"><pre class="sourceCode apache"><code class="sourceCode apache"><span class="fu">&lt;Location</span><span class="at"> &quot;[absolute directory of .htaccess file]&quot;</span><span class="fu">&gt;</span>
    [contents of .htaccess file]
<span class="fu">&lt;/Location&gt;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="chrooting">Chrooting</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="fu">mkdir</span> -p /jail/apache/usr/local
<span class="bu">cd</span> /usr/local
<span class="fu">mv</span> apache /jail/apache/usr/local

<span class="bu">echo</span> <span class="st">&quot;SecChrootDir /jail/apache&quot;</span> <span class="op">&gt;&gt;</span> <span class="va">$HTTPD_CONF</span>
<span class="ex">/usr/local/apache/bin/apachectl</span> startssl</code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="configuring-ssl">Configuring SSL</h3>
<p>Modify the below snippet to your site's needs and add it to your configuration file.</p>
<div class="sourceCode"><pre class="sourceCode apache"><code class="sourceCode apache">LoadModule<span class="st"> ssl_module modules/mod_ssl.so</span>

Listen<span class="st"> 443</span>
<span class="fu">&lt;VirtualHost</span><span class="at"> *:443</span><span class="fu">&gt;</span>
    ServerName<span class="st"> www.example.com</span>
    <span class="ex">SSLEngine</span><span class="ch"> </span><span class="kw">on</span>
    SSLCertificateFile<span class="st"> &quot;/path/to/www.example.com.cert&quot;</span>
    SSLCertificateKeyFile<span class="st"> &quot;/path/to/www.example.com.key&quot;</span>
<span class="fu">&lt;/VirtualHost&gt;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="prevent-leaking-web-application-data">Prevent Leaking Web Application Data</h3>
<p>The following files should be edited to prevent common ways web applications leak data.</p>
<h4 id="robots.txt">robots.txt</h4>
<pre class="txt"><code>User-agent: *
Disallow: /</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="bind">BIND</h2>
<p>BIND is a common, featured DNS server. To make it more secure and less vulnerable to attacks, it is recommended to only run BIND as an authoritative nameserver and not as a recursive nameserver.</p>
<h3 id="config-files-6">Config Files</h3>
<p>The configuration for BIND is usually stored in either:</p>
<ul>
<li>'/etc/bind/' (Debian-based distributions)</li>
<li>'/etc/named/' (other distributions)</li>
<li>'/etc/named.conf' (RedHat-based distributions)</li>
<li>'/var/named/' (RedHat-based distributions)</li>
</ul>
<p>Utilize the named-checkconf utility to check configuration before applying it.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="example-configuration-5">Example Configuration</h3>
<p>Below is a set of example configuration files for securely configuring BIND as an authoritative nameserver with forward and reverse records.</p>
<h4 id="etcnamed.conf">/etc/named.conf</h4>
<pre class="bindconf"><code>options {
   # disable zone transfers, queries, and insecure options
   allow-transfer { &quot;none&quot;; };
   version &quot;none&quot;;
   fetch-glue no;

   # if we have another DNS recursor, disable recursion
   recursion no;
   allow-query { &quot;none&quot;; };

   # if we are a DNS recursor, only allow queries
   # from the local network or only  for specific hosts
   #recursion yes;
   #allow-query { 10.0.0.0/24; localhost; };
   #allow-query { &quot;none&quot;; };
};

# if we are a DNS recursor,
# set forwarding addresses to another nameserver
#forwarders {
#    8.8.8.8;
#    8.8.4.4;
#};</code></pre>
<h4 id="varnamedexample.com.conf">/var/named/example.com.conf</h4>
<pre class="bindconf"><code># replace example.com with the actual domain
zone &quot;example.com&quot; {
    type master;
    # rhel puts these in /var/named
    file &quot;/etc/bind/zones/db.example.com&quot;;

    # allow queries to this zone from anywhere
    allow-query { any; };
};

# 10.0.0.0/24 subnet, put address octets backwards
zone &quot;0.0.10.in-addr.arpa&quot; {
    type master;
    # rhel puts these in /var/named
    file &quot;/etc/bind/zones/db.10.0.0&quot;;

    # allow queries to this zone from anywhere
    allow-query { any; };
};</code></pre>
<h4 id="varnameddb.example.com">/var/named/db.example.com</h4>
<pre class="bind"><code>$ORIGIN example.com.

; TTL of 10 minutes for quick change during competitions
$TTL    600

; hostmaster.example.com. is the email hostmaster@example.com
@       IN      SOA     ns1.example.com. hostmaster.example.com. (
                                         1       ; Serial
                                         600     ; Refresh
                                         600     ; Retry
                                         2419200 ; Expire
                                         600     ; Negative Cache TTL
                                                 ; (how long to cache
                                                 ;  negative (e.g. NXDOMAIN)
                                                 ;  responses)
                                         )
        IN      NS      ns1         ; this box
        IN      MX  10  mail        ; mail box
        IN      A       10.0.0.103  ; www box (resolve example.com
                                               to the same address as
                                               www.example.com)

ns1     IN      A       10.0.0.101
mail    IN      A       10.0.0.102
www     IN      A       10.0.0.103</code></pre>
<h4 id="varnameddb.10.0.0">/var/named/db.10.0.0</h4>
<pre class="bind"><code>; put address octets backwards
$ORIGIN 0.0.10.in-addr.arpa.

; TTL of 10 minutes for quick change during competitions
$TTL    600

; hostmaster.example.com. is the email hostmaster@example.com
@       IN      SOA     ns1.example.com. hostmaster.example.com. (
                                         1       ; Serial
                                         600     ; Refresh
                                         600     ; Retry
                                         2419200 ; Expire
                                         600     ; Negative Cache TTL
                                                 ; (how long to cache
                                                    negative (e.g. NXDOMAIN)
                                                    responses)
                                         )
        IN      NS      ns1         ; this box

; if on a bigger subnet, put octets backwards (i.e. 101.0.0)
101     IN      PTR     ns1         ; 10.0.0.101
102     IN      PTR     mail        ; 10.0.0.102
103     IN      PTR     www         ; 10.0.0.103</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="mysql">MySQL</h2>
<p>MariaDB, and its predecessor MySQL, is a quick database for small to medium size organizations.</p>
<h3 id="installation-3">Installation</h3>
<p>Install from the repositories then use the command <code>mysql_secure_installation</code>.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="common-tasks">Common Tasks</h3>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="co">-----------------------------</span>
<span class="co">-- Listing Databases and Tables:</span>
<span class="co">-----------------------------</span>

SHOW DATABASES; <span class="co">-- lists every db, make sure to DROP the ones you don&#39;t need</span>
<span class="kw">USE</span> openemr; <span class="co">-- selects a certain database so future operations run on it</span>
SHOW <span class="kw">TABLES</span>; <span class="co">-- displays every table in the current database</span>


<span class="co">-----------------------------</span>
<span class="co">-- Verify all database users:</span>
<span class="co">-----------------------------</span>

# mysql -u root -p <span class="co">-- Login with root</span>
<span class="co">-- Type in root password in prompt. If root doesn&#39;t have a password, you should set one now:</span>
<span class="kw">UPDATE</span> mysql.User <span class="kw">SET</span> Password=PASSWORD(<span class="st">&#39;new root password&#39;</span>) <span class="kw">WHERE</span> User=<span class="st">&#39;root&#39;</span>;
<span class="co">-- Get list of all users:</span>
<span class="kw">SELECT</span> Host, <span class="fu">User</span>, <span class="kw">Password</span> <span class="kw">from</span> mysql.User;

<span class="co">--If there are users that shouldn&#39;t be there, delete</span>
<span class="co">--them (remember that % and _ are wildcards, % means 0 or more</span>
<span class="co">--characters and _ means exactly one character).</span>

<span class="co">--Delete all bad users. This should include all anonymous users, and any user</span>
<span class="co">--that has a Host OTHER than &#39;localhost&#39; (especially root!)</span>

<span class="kw">DROP</span> <span class="fu">USER</span> <span class="st">&#39;username&#39;</span>@<span class="st">&#39;hostname&#39;</span>;
<span class="co">-- repeat for each undesired user</span>
<span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;
<span class="co">-- run this after you finish deleting users and/or changing user passwords</span>


<span class="co">--If this is at the beginning of competition, you should delete all non</span>
<span class="co">--root@localhost users and only add them back if you need to. Chances are the</span>
<span class="co">--server is set up to allow an anonymous user or a user with root-like access</span>
<span class="co">--and a weak password full control over the database(s), so the best way to</span>
<span class="co">--prevent an intrusion from Red Team is to outright delete these users. You</span>
<span class="co">--(probably) do not need to worry about copying down password hashes, as if</span>
<span class="co">--some application is using MySQL the password will be stored in plaintext in</span>
<span class="co">--that application, and if not then you should be able to submit a Memo to</span>
<span class="co">--White Team to change a user&#39;s password. That said, it might be a good idea</span>
<span class="co">--anyways as long as you store it somewhere that Red Team can&#39;t get at and it</span>
<span class="co">--isn&#39;t against Policy.</span>


<span class="co">-----------------------------</span>
<span class="co">-- Creating new users:</span>
<span class="co">-----------------------------</span>
<span class="co">--You should only create users with specific access</span>
<span class="co">--to a specific database (e.g. one user per application that uses a database).</span>
<span class="co">--Additionally, you should restrict the Host as much as possible. If your</span>
<span class="co">--webapp is running on the same box as the db server, make the host localhost,</span>
<span class="co">--otherwise make the host the IP of the box running the webapp. ONLY IF REMOTE</span>
<span class="co">--DATABASE ACCESS IS REQUIRED BY THE INJECT should you open up the host to</span>
<span class="co">--something outside of your team&#39;s network (e.g. &#39;%&#39;)</span>

<span class="co">--Create the database first</span>
<span class="kw">CREATE</span> <span class="kw">DATABASE</span> webapp_name;

<span class="co">--Now add a user to it with a secure password:</span>
<span class="co">--With minimal write access (can add/delete records, but not add/drop tables or</span>
<span class="co">--table structures)</span>

<span class="kw">GRANT</span> <span class="kw">INSERT</span>, <span class="kw">UPDATE</span>, <span class="kw">SELECT</span>, <span class="kw">DELETE</span> <span class="kw">ON</span> webapp_name.* <span class="kw">TO</span>
    <span class="st">&#39;database_user&#39;</span>@<span class="st">&#39;hostname per above&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;password goes here&#39;</span>;
<span class="co">--With full write access to the given database</span>
<span class="kw">GRANT</span> <span class="kw">ALL</span> <span class="kw">PRIVILEGES</span> <span class="kw">ON</span> webapp_name.* <span class="kw">TO</span>
    <span class="st">&#39;database_user&#39;</span>@<span class="st">&#39;hostname per above&#39;</span> <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;password goes here&#39;</span>;


<span class="co">-----------------------------</span>
<span class="co">-- Get a user&#39;s Perms:</span>
<span class="co">-----------------------------</span>
SHOW GRANTS <span class="kw">FOR</span> <span class="st">&#39;user&#39;</span>@<span class="st">&#39;host&#39;</span>;

<span class="kw">SELECT</span> * <span class="kw">FROM</span> mysql.User <span class="kw">where</span> User=<span class="st">&#39;user&#39;</span> <span class="kw">and</span> Host=<span class="st">&#39;host&#39;</span>;
<span class="co">--If you see a lot of Y&#39;s and the user ISN&#39;T root@localhost, something is wrong.</span>


<span class="co">-----------------------------</span>
<span class="co">-- Backing up and restoring the database:</span>
<span class="co">-----------------------------</span>
<span class="co">--This should be in your list of things to do at</span>
<span class="co">--the beginning of competition, as well as semi-frequently throughout when you</span>
<span class="co">--do installations of new webapps, etc. Each command will prompt you to type</span>
<span class="co">--the root password into the terminal. This is safer than providing the</span>
<span class="co">--password in the command line because it does not get saved in .bash_history</span>
<span class="co">--and possibly other places.</span>

<span class="co">-- # is beginning of shell (Linux):</span>
<span class="co">--Backup:</span>
<span class="co">-- # mysqldump --all-databases -u root -p &gt; backup.sql</span>
<span class="co">--Restore:</span>
<span class="co">-- # mysql -u root -p &lt; backup.sql</span>


<span class="co">-----------------------------</span>
<span class="co">-- Reset root password:</span>
<span class="co">-----------------------------</span>
<span class="co">--Stop MySQL</span>
<span class="co">-- # mysqld -u mysql --skip-grant-tables</span>
<span class="co">-- # mysql -u root --Connect as root</span>

<span class="kw">UPDATE</span> mysql.User <span class="kw">SET</span> Password=PASSWORD(<span class="st">&#39;new root password&#39;</span>) <span class="kw">WHERE</span> User=<span class="st">&#39;root&#39;</span>;
<span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;

<span class="co">--to re-load the grant tables and make root and all other users</span>
<span class="co">--have passwords again</span></code></pre></div>
<h4 id="securing">Securing</h4>
<ul>
<li>Make sure it is only listening on localhost unless remote access is required by an inject (or the scoring engine) or you are running the webapps on a different server</li>
<li>Look for <code>bind-address</code> in the <code>[mysqld]</code> section and ensure it is set to <code>127.0.0.1</code> for allowing local connections only or <code>0.0.0.0</code> for allowing remote connections</li>
<li>Disable the <code>LOCAL INFILE</code> queries, which allows someone (i.e. red team) to upload files from their computers into your database, by adding <code>local-infile = 0</code> to the <code>[mysqld]</code> section of the config file</li>
<li>Restart MySQL after making any configuration changes</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="openssl">OpenSSL</h2>
<p>OpenSSL is a toolkit for the TLS protocol and a general purpose cryptography library.</p>
<h3 id="generate-tls-certificates">Generate TLS Certificates</h3>
<p>Below is a command to generate a key file and TLS certificate for use in Apache or other server. Copy the generated files to the appropriate place (e.g. '/etc/httpd/conf/ssl.key' and '/etc/httpd/conf/ssl.crt') and make them writable only by root and readable by the web server group (e.g. <code>chown -R root:httpd /etc/httpd/conf/ssl.{key,crt} &amp;&amp; chmod 640 /etc/httpd/conf/ssl.{key,crt}</code>). The output files are <code>example.pem</code>, the key, and <code>example.crt</code>, the certificate.</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="ex">openssl</span> req -x509 -newkey rsa:2048 -nodes -sha256 -days 365 \
    -keyout example.pem -out example.crt \
    -subj <span class="st">&#39;/O=Example, Inc./CN=example.com&#39;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="postfix">Postfix</h2>
<p>Postfix is a secure replacement for Sendmail. It features very strong process and privilege separation while keeping an interface roughly consistent with Sendmail. It should work out of the box for local mail delivery and relaying given the mail hostname.</p>
<h3 id="full-mta">Full MTA</h3>
<h4 id="etcpostfixmain.cf">/etc/postfix/main.cf</h4>
<pre class="postfix"><code>myhostname = [hostname]</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="send-only">Send Only</h3>
<p>Postfix should be used in place of Sendmail for the case of sending emails. It is easy to install and for send-only has minimal required configuration.</p>
<h4 id="etcpostfixmain.cf-1">/etc/postfix/main.cf</h4>
<p>Apply the below configuration where the original options are in the main configuration file. These will only allow connections from localhost and disable local delivery.</p>
<pre class="postfix"><code>inet_interfaces = loopback-only
local_transport = error:local delivery is disabled</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="samba">Samba</h2>
<p>Samba is reimplementation of the Serial Message Block Protocol from Windows.</p>
<h3 id="example-configuration-6">Example Configuration</h3>
<p>The following configuration allows the machine to authneticate to a Windows AD via Kerberos.</p>
<h4 id="samba.conf">samba.conf</h4>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="co"># this config file based on the Archlinux Wiki which is published under the GFDL</span>

<span class="kw">[Global]</span>
<span class="dt">    </span><span class="co">#Server information</span>
<span class="dt">    netbios name </span><span class="ot">=</span><span class="st"> EXAMPLEHOST</span>
<span class="dt">    workgroup </span><span class="ot">=</span><span class="st"> EXAMPLE</span>
<span class="dt">    realm </span><span class="ot">=</span><span class="st"> EXAMPLE.COM</span>
<span class="dt">    server string </span><span class="ot">=</span><span class="st"> %h  Host</span>

<span class="dt">    </span><span class="co">#Authentication</span>
<span class="dt">    security </span><span class="ot">=</span><span class="st"> ads</span>
<span class="dt">    encrypt passwords </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">    password server </span><span class="ot">=</span><span class="st"> ad_server.example.com</span>
<span class="dt">    idmap config * : backend </span><span class="ot">=</span><span class="st"> rid</span>
<span class="dt">    idmap config * : range </span><span class="ot">=</span><span class="st"> </span><span class="dv">10000-20000</span>

<span class="dt">    </span><span class="co">#Windows domain authentication</span>
<span class="dt">    winbind use default domain </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    winbind enum users </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    winbind enum groups </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    winbind nested groups </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    winbind separator </span><span class="ot">=</span><span class="st"> +</span>
<span class="dt">    winbind refresh tickets </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">    winbind offline logon </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">    winbind cache time </span><span class="ot">=</span><span class="st"> </span><span class="dv">300</span>

<span class="dt">    </span><span class="co">#New User Template</span>
<span class="dt">    template shell </span><span class="ot">=</span><span class="st"> /bin/bash</span>
<span class="dt">    template homedir </span><span class="ot">=</span><span class="st"> /home/%D/%U</span>

<span class="dt">    preferred master </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">    dns proxy </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">    wins server </span><span class="ot">=</span><span class="st"> ad_server.example.com</span>
<span class="dt">    wins proxy </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>

<span class="dt">    inherit acls </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    map acl inherit </span><span class="ot">=</span><span class="st"> </span><span class="kw">Yes</span>
<span class="dt">    acl group control </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>

<span class="dt">    load printers </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">    debug level </span><span class="ot">=</span><span class="st"> </span><span class="dv">3</span>
<span class="dt">    use sendfile </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span></code></pre></div>
<h4 id="smb.conf">smb.conf</h4>
<div class="sourceCode"><pre class="sourceCode ini"><code class="sourceCode ini"><span class="kw">[ExampleShare]</span>
<span class="dt">  comment </span><span class="ot">=</span><span class="st"> Example Share</span>
<span class="dt">  path </span><span class="ot">=</span><span class="st"> /srv/exports/example</span>
<span class="dt">  read only </span><span class="ot">=</span><span class="st"> </span><span class="kw">no</span>
<span class="dt">  browseable </span><span class="ot">=</span><span class="st"> </span><span class="kw">yes</span>
<span class="dt">  valid users </span><span class="ot">=</span><span class="st"> @NETWORK+&quot;Domain Admins&quot; NETWORK+test.user</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="openssh">OpenSSH</h2>
<p>SSH or Secure Shell is a remote administration protocol. It allows the user to send remote commands to Linux machines (and soon to versions of Windows 10 or later). It can be a vary powerful tool for system administration, but can also be a powerful exploit target if not secured. It is used with a variety of tools, including the provisioning tool Ansible and back up tool rsnapshot for secure connections. In general there are a few best practices to follow for using ssh.</p>
<h3 id="best-practices-1">Best Practices</h3>
<ul>
<li>Disable root login.</li>
<li>Disable password authentication (default).</li>
<li>Disable host-based authentication (default).</li>
<li>Ensure that ssh is not setuid to prevent host-based authentication.</li>
<li>Use at least public key authentication and use 2-factor authentication where possible.</li>
<li>During competition revoke all authorized keys except when required by the scoring engine.</li>
<li>Use sandbox privilege separation to prevent privilege escalation attacks on the daemon (default).</li>
<li>Use PAM (pluggable authentication module) (default).</li>
<li>Block excessive connections to ssh at the firewall.</li>
<li>Do not forward the SSH Agent to untrusted/compromised servers.</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="config-files-7">Config Files</h3>
<p>Important system level configuration directories and files:</p>
<ul>
<li>'/etc/sshd/sshd_config' - daemon configuration</li>
<li>'/etc/hosts.equiv' - used for insecure host based authentication; remove when found</li>
<li>'/etc/shosts.equiv' - used for insecure host based authentication; remove when found</li>
<li>'/etc/ssh/ssh_known_hosts' - system wide list of host keys</li>
<li>'/etc/ssh/ssh_host_*key' - private keys used for host-based authentication and fingerprints</li>
<li>'/etc/ssh/sshrc' - commands that are executed when the user logs on</li>
</ul>
<p>Important user level configuration directories and files:</p>
<ul>
<li>'~/.rhosts' - used for insecure host based authentication; remove when found</li>
<li>'~/.shosts' - used for insecure host based authentication; remove when found</li>
<li>'~/.ssh/known_hosts' - list of hosts that are not already in /etc/ssh/ssh_known_hosts</li>
<li>'~/.ssh/authorized_keys' - list of keys that can be used to authenticate as this user</li>
<li>'~/.ssh/config' - per user configuration options for ssh</li>
<li>'~/.ssh/environment' - environment options for the user</li>
<li>'~/.ssh/id*.pub' - public key for the user</li>
<li>'~/.ssh/id*' - private key for the user</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="configuration-3">Configuration</h3>
<h4 id="etcsshsshd_config">/etc/ssh/sshd_config</h4>
<pre class="sshconf"><code>PermitRootLogin no
UsePAM yes
UsePrivilegeSeparation sandbox
AcceptEnv LANG LC_*
ClientAliveInterval 300
ClientAliveCountMax 0</code></pre>
<h4 id="purge-user-keys">Purge User Keys</h4>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="kw">for</span> <span class="ex">key_dir</span> in <span class="va">$(</span><span class="fu">awk</span> <span class="st">&#39;BEGIN { FS=&quot;:&quot;} {print $6}&#39;</span> /etc/passwd<span class="va">)</span><span class="kw">;</span> <span class="kw">do</span>
    <span class="kw">if</span><span class="bu"> [</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh&quot;</span><span class="bu"> ]</span>; <span class="kw">then</span>
        <span class="bu">test</span> -f <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/authorized_keys&quot;</span> <span class="kw">&amp;&amp;</span> <span class="kw">\</span>
            <span class="fu">mv</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/authorized_keys&quot;</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/authorized_keys~&quot;</span> <span class="op">&amp;&gt;</span>/dev/null
        <span class="bu">test</span> -f <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/rhosts&quot;</span> <span class="kw">&amp;&amp;</span> <span class="kw">\</span>
            <span class="fu">mv</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/rhosts&quot;</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/rhosts~&quot;</span> <span class="op">&amp;&gt;</span>/dev/null
        <span class="bu">test</span> -f <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/shosts&quot;</span> <span class="kw">&amp;&amp;</span> <span class="kw">\</span>
            <span class="fu">mv</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/shosts&quot;</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/shosts~&quot;</span> <span class="op">&amp;&gt;</span>/dev/null
        <span class="fu">ls</span> <span class="st">&quot;</span><span class="va">$key_dir</span><span class="st">/.ssh/id*&quot;</span> <span class="op">&amp;&gt;</span> /dev/null <span class="kw">&amp;&amp;</span> <span class="bu">echo</span> <span class="st">&quot;found keys at </span><span class="va">$key_dir</span><span class="st">/.ssh&quot;</span>
    <span class="kw">fi</span>
<span class="kw">done</span></code></pre></div>
<h4 id="purge-system-keys">Purge System Keys</h4>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="bu">test</span> -f /etc/hosts.equiv <span class="kw">&amp;&amp;</span> <span class="fu">mv</span> /etc/hosts.equiv /etc/hosts.equiv~ <span class="op">&amp;&gt;</span> /dev/null
<span class="bu">test</span> -f /etc/shosts.equiv <span class="kw">&amp;&amp;</span> <span class="fu">mv</span> /etc/shosts.equiv /etc/shosts.equiv~ <span class="op">&amp;&gt;</span> /dev/null</code></pre></div>
<p>Do not forget to restart sshd after configuration.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="apache-tomcat">Apache Tomcat</h2>
<p>Apache Tomcat is a web server designed to serve Java Server Page (JSP) web applications.</p>
<h3 id="installation-4">Installation</h3>
<ul>
<li>Avoid running tomcat with other services</li>
<li>Remove the sample server files</li>
<li>Do not reveal excess information
<ul>
<li>Do not advertise version information</li>
<li>Disable X-Powered-By HTTP header by setting <code>xpoweredBy=&quot;false&quot;</code> in the Connectors</li>
<li>Disable Allow Trace HTTP header by setting <code>allowTrace=&quot;false&quot;</code> in the Connectors</li>
<li>Disable Client facing Stack Traces</li>
</ul></li>
<li>Protect shutdown port by either disable by setting port to -1 or setting shutdown value to a random value</li>
<li>Ensure that file permissions are correct
<ul>
<li>Make <code>$CATALINA_HOME</code> owned by <code>tomcat_admin:tomcat</code> with permissons 750</li>
<li>Make <code>$CATALINA_BASE</code> owned by <code>tomcat_admin:tomcat</code> with permissons 750</li>
<li>Make <code>$CATALINA_HOME/conf</code> owned by <code>tomcat_admin:tomcat</code> with permissons 770</li>
<li>Make <code>$CATALINA_HOME/logs</code> owned by <code>tomcat_admin:tomcat</code> with permissons 770</li>
<li>Make <code>$CATALINA_HOME/temp</code> owned by <code>tomcat_admin:tomcat</code> with permissons 770</li>
<li>Make <code>$CATALINA_HOME/bin</code> owned by <code>tomcat_admin:tomcat</code> with permissons 750</li>
<li>Make <code>$CATALINA_HOME/webapps</code> owned by <code>tomcat_admin:tomcat</code> with permissons 750</li>
<li>Make <code>$CATALINA_HOME/conf/catalina.policy</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
<li>Make <code>$CATALINA_HOME/conf/catalina.properties</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
<li>Make <code>$CATALINA_HOME/conf/logging.properties</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
<li>Make <code>$CATALINA_HOME/conf/server.xml</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
<li>Make <code>$CATALINA_HOME/conf/tomcat-users.xml</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
<li>Make <code>$CATALINA_HOME/conf/web.xml</code> owned by <code>tomcat_admin:tomcat</code> with permissons 600</li>
</ul></li>
<li>Use better authentication
<ul>
<li>Configure Realms to not use MemoryRealm in server.xml</li>
<li>Configure Realms to use LockOutRealms</li>
<li>If possible use Client-Cert Authentication by setting <code>clientAuth=&quot;True&quot;</code> in server.xml</li>
</ul></li>
<li>Use SSL where possible
<ul>
<li>Ensure that SSLEnabled is set to True for Sensitive Connectors in server.xml</li>
<li>Set the scheme to &quot;https&quot; in connectors in server.xml</li>
<li>Ensure that secure is set to false on connectors that are not using SSL in sever.xml.</li>
<li>Ensure that the sslProtocol is &quot;TLS&quot; for all connectors using SSLEngine in server.xml.</li>
</ul></li>
<li>Configure Logging
<ul>
<li>Ensure the following lines are in logging.properties <code>handlers=org.apache.juli.FileHandler, java.util.logging.ConsoleHandler</code></li>
<li>Ensure the following lines are in logging.properties <code>org.apache.juli.FileHandler.level=FINEST</code></li>
<li>Ensure that <code>className</code> is set to <code>org.apache.catalina.valves.FastCommonAccessLogValve</code> in <code>$CATALINA_BASE/&lt;app name&gt;/META-INF/context.xml</code></li>
<li>Ensure that directory is set to <code>$CATALINA_HOME/logs</code> |in <code>$CATALINA_BASE/&lt;app name&gt;/META-INF/context.xml</code></li>
<li>Ensure that pattern is set to <code>&quot;%t % U %a %A %m %p %q %s&quot;</code> in <code>$CATALINA_BASE/&lt;app name&gt;/META-INF/context.xml</code></li>
</ul></li>
<li>Prevent unexpected code execution
<ul>
<li>Set package.access = <code>sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper</code> in conf/catalina.properties</li>
<li>Ensure that Tomcat is started with <code>-security</code></li>
<li>Ensure that <code>autoDeploy=&quot;false&quot;</code> in server.xml</li>
<li>Ensure that <code>deployOnStartup=&quot;false&quot;</code> in server.xml</li>
</ul></li>
<li>Protect the manager application
<ul>
<li>Ensure that the valves with the class RemoteAddrValve is set to allow on <code>127.0.0.1</code> only in server.xml</li>
<li>Ensure that the valves with the class RemoteAddrValve is set to allow on <code>127.0.0.1</code> only in &quot;webapps/host-manager/manager.xml&quot; if it must be used</li>
<li>Force SSL to access manager if it must be used</li>
<li>Rename the manager application by renaming the xml file and moving the app to a new corresponding directory</li>
</ul></li>
<li>Disable insecure startup settings
<ul>
<li>Ensure that <code>-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true</code> is set in startup script</li>
<li>Ensure that <code>-Dorg.apache.catalina.connector.RECYCLE_FACADES=false</code> is set in startup script</li>
<li>Ensure that <code>-Dorg.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH=false</code> is set in startup script</li>
<li>Ensure that <code>-Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=false</code> is set in startup script</li>
<li>Ensure that <code>-Dorg.apache.coyote.USE_CUSTOM_STATUS_MSG_IN_HEADER=false</code> is set in startup script</li>
</ul></li>
<li>Do not allow symbolic linking in context.xml by setting <code>allowLinking=&quot;false&quot;</code></li>
<li>Do not run applications as privileged in context.xml by setting <code>privileged=&quot;false&quot;</code></li>
<li>Do not allow cross context requests in context.xml by setting <code>crossContext=&quot;false&quot;</code></li>
<li>Do not allow resolving hosts on logging Valves by setting <code>resolveHosts=&quot;false&quot;</code></li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="configuration-4">Configuration</h3>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co"># remove sample resources</span>
<span class="fu">rm</span> -rf <span class="va">$CATALINA_HOME</span>/webapps/<span class="dt">{js-examples,servlet-example,webdav,tomcat-docs,balancer}</span>
<span class="fu">rm</span> -rf <span class="va">$CATALINA_HOME</span>/webapps/<span class="dt">{ROOT/admin,examples}</span>
<span class="fu">rm</span> -rf <span class="va">$CATALINA_HOME</span>/server/webapps/<span class="dt">{host-manager,manager}</span>
<span class="fu">rm</span> -rf <span class="va">$CATALINA_HOME</span>/conf/Catalina/localhost/<span class="dt">{host-manager,manager}</span>.xml

<span class="co"># ensure that only needed connectors are configured remove unused connectors</span>
<span class="fu">grep</span> <span class="st">&quot;Connector&quot;</span> <span class="va">$CATALINA_HOME</span>/conf/server.xml

<span class="co"># edit the server properties string to hide properties</span>
<span class="co">#tomcat 5.5</span>
<span class="bu">cd</span> <span class="va">$CATALINA_HOME</span>/server/lib
<span class="co">#tomcat 6.0</span>
<span class="bu">cd</span> <span class="va">$CATALINA_HOME</span>/lib
<span class="co">#both</span>
<span class="ex">jar</span> xf catalina.jar org/apache/catalina/util/ServerInfo.properties
<span class="ex">vim</span> org/apache/catalina/util/ServerInfo.properties
<span class="ex">jar</span> uf catalina.jar

<span class="co"># disable client facing stack traces</span>
<span class="ex">vim</span> error.jsp
<span class="co"># create a error page with out useful information</span>
<span class="ex">vim</span> <span class="va">$CATALINA_HOME</span>/conf/web.xml
<span class="co"># add a section that looks like this in the &lt;web-app&gt; element</span>
<span class="co"># &lt;error-page&gt;</span>
<span class="co">#   &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;</span>
<span class="co">#   &lt;location&gt;/path/to/error.jsp&lt;/location&gt;</span>
<span class="co"># &lt;/error-page&gt;</span>

<span class="co"># configure LockOutRealms</span>
<span class="ex">vim</span> <span class="va">$CATALINA_HOME</span>/conf/server.xml
<span class="co"># add a section that looks like this wrapping the main realm</span>
<span class="co">#  &lt;Realm className=&quot;org.apache.catalina.realm.LockOutRealm&quot; failureCount=&quot;3&quot;</span>
<span class="co">#         lockOutTime=&quot;600&quot; cacheSize=&quot;1000&quot; cacheRemovalWarningTime=&quot;3600&quot;&gt;</span>
<span class="co">#    ... MAIN REALM ...</span>
<span class="co">#  &lt;/Realm&gt;</span>

<span class="co"># force SSL when accessing the manager application</span>
<span class="ex">vim</span> <span class="va">$CATALINA_HOME</span>/<span class="dt">{server/,}</span>webapps/manager/WEB-INF/web.xml
<span class="co"># add lines that look like this</span>
<span class="co"># &lt;security-contraint&gt;</span>
<span class="co">#   &lt;user-data-constraint&gt;</span>
<span class="co">#      &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;</span>
<span class="co">#   &lt;/user-data-constraint&gt;</span>
<span class="co"># &lt;/security-contraint&gt;</span></code></pre></div>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="vsftpd">VSFTPD</h2>
<p>When an FTP server needs to be created or migrating to a more secure box, the FTP server of choice is vsftpd. Apply the following changes to the configuration file to reduce privileges and spoof the banner as the Windows FTP server. If migrating the server, copy all of the FTP files from the old server to '/home/ftp' using the <code>ftp</code> command.</p>
<h5 id="etcvsftpd.conf">/etc/vsftpd.conf</h5>
<p>```conf nopriv_user=ftp ftpd-banner=Windows FTP Server</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="wordpress">Wordpress</h2>
<p>Wordpress is a PHP content management system. It has reasonable security in a new default install, but has a poor track record for remote execution exploits. The best way to secure Wordpress is to update it if possible and remove all unnecessary or old plugins.</p>
<h3 id="setup">Setup</h3>
<p>Download the latest tarball available at 'https://wordpress.org/latest.tar.gz' and untar it into the document root (i.e. '/var/www'). Create and configure the necessary using the following SQL commands.</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="fu">USER</span> wordpress@localhost <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> <span class="st">&#39;password&#39;</span>;
<span class="kw">CREATE</span> <span class="kw">DATABASE</span> wordpress;
<span class="kw">GRANT</span> <span class="kw">SELECT</span>,<span class="kw">INSERT</span>,<span class="kw">UPDATE</span>,<span class="kw">DELETE</span> <span class="kw">ON</span> wordpress.* <span class="kw">TO</span> wordpress@localhost;
<span class="kw">FLUSH</span> <span class="kw">PRIVILEGES</span>;</code></pre></div>
<p>Navigate to the setup page at 'http://localhost/wordpress/' and follow the setup instructions. Proceed below with how to add a few extra layers of security to a Wordpress installation.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="securing-1">Securing</h3>
<ul>
<li>Make sure file permissions are restrictive
<ul>
<li>'/' needs to be writable only by the owning user account (e.g. 'www')</li>
<li>'/wp-content' needs to be writable by web server (e.g. 'apache')</li>
<li>'/wp-content/plugins' needs to be writable only by the owning user account (e.g. 'www')</li>
</ul></li>
<li>Remove unnecessary database permissions
<ul>
<li>reduce database permissions for the SQL user by running the following command, replacing <code>wordpress.*</code> with the Wordpress tables and <code>wordpress@localhost</code> with the Wordpress user if necessary.</li>
<li><code>REVOKE ALL PRIVILEGES ON wordpress.* from wordpress@localhost;</code></li>
<li><code>GRANT SELECT,INSERT,UPDATE,DELETE ON wordpress.* TO wordpress@localhost; FLUSH PRIVILEGES;</code></li>
</ul></li>
<li>Disable file editing from wp-admin
<ul>
<li>add <code>define('DISALLOW_FILE_EDIT', true);</code> to 'wp-config.php'</li>
</ul></li>
<li>Move 'wp-config.php' to the directory above the Wordpress root</li>
<li>Add 'AskApache Password Protect' which enables HTTP authentication preventing wp-admin from being exploited</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="sniffers-and-information-gathering">Sniffers and Information Gathering</h1>
<h2 id="nmap">Nmap</h2>
<p>Nmap is a network exploration tool, port scanner, and service scanner. It is useful for preforming host enumeration on IPv4 networks and auditing ports and services on specific hosts on IPv4 and IPv6 networks.</p>
<h3 id="common-options">Common Options</h3>
<p>There are several main use cases and common options here:</p>
<div class="sourceCode"><pre class="sourceCode sh"><code class="sourceCode bash"><span class="co">#!/bin/sh</span>
<span class="co"># most common options</span>

<span class="co"># ping scan of a IPv4 network</span>
<span class="fu">nmap</span> -sn 192.168.1.0/24

<span class="co"># agressive scan of a IPv4 host</span>
<span class="fu">nmap</span> -T4 -A 192.168.1.1/32

<span class="co"># agressive scan of a hostname resolved via dns</span>
<span class="fu">nmap</span> -T4 -A www.foobar.com

<span class="co"># agressive scan of a IPv6 host</span>
<span class="fu">nmap</span> -6 -T4 -A 2::dead:beaf:cafe/128

<span class="co"># agressive scan of a file of hosts/networks separated by newlines</span>
<span class="fu">nmap</span> -T4 -A -iL inputfile.txt</code></pre></div>
<h4 id="host-discovery-options">Host Discovery Options</h4>
<p>For host discovery, the most important flag is <code>-sn</code>. It sends an ICMP ECHO to each target host. In IPv4 networks, this is a fast and easy way to enumerate hosts for a deeper scan.</p>
<p>In IPv6 networks, the address space is probably too large to do this effectively. On solution in this case to examine the network switch MAC table or to use tcpdump or wireshark to sniff for packets.</p>
<p>To conduct discovery using different types of packets use the <code>-P{n,S,A,U,Y}</code> option which uses no pings, SYN, ACK, UDP, and SCTP packets respectively.</p>
<h4 id="port-scanning-options">Port Scanning Options</h4>
<p>By default, Nmap scans the 1000 most commonly used ports. To use Nmap to scan for specific ports, use the <code>-p</code> flag to specify which ports to scan. It accepts hyphen separated ranges and comma separated lists. To scan all ports, use the --allports long option. To use a different type of packets use the <code>-s{S,T,A,W,U,Y}</code> option which tests with SYN, TCP connect, ACK, UDP, and SCTP INIT packets respectively.</p>
<h4 id="service-scanning-options">Service Scanning Options</h4>
<p>There are several commons flags to use here:</p>
<ul>
<li><code>-O</code> will run OS detection against the target</li>
<li><code>-sV</code> will run service version detection against the target</li>
<li><code>-sC</code> will run common default scripts against the target to detect various things</li>
<li><code>--script=&quot;&lt;script_name&gt;&quot;</code> will specify a script or group of scripts to run against the targets</li>
<li><code>-A</code> will enable OS detection, version detection, script scanning, and traceroute</li>
</ul>
<p>Scripts that are available can often be found the '/usr/share/nmap' directory. Refer to these for examples on how to write scripts.</p>
<h4 id="timing-and-optimization">Timing and Optimization</h4>
<p>Nmap has a series of timing and optimizations that can be run. The most useful is -T[1-5] which specifies how quickly packets are to be sent, 1 is the slowest and 5 is the fastest. You can also specify max retries via the --max-retries long option. You can also specify max timeout via the --host-timeout long option.</p>
<h4 id="evasive-options">Evasive Options</h4>
<p>If you are running Nmap offensively, there are several flags that control how evasive Nmap behaves. These allow for spoofing of IP address (<code>-S</code>) and MAC address (<code>--spoof-mac</code>) and for setting various options for sending custom packets.</p>
<h4 id="output-options">Output Options</h4>
<p>There are various output options the most important are:</p>
<ul>
<li><code>-oN &lt;file_name&gt;</code> will send normal output to a file</li>
<li><code>-oG &lt;file_name&gt;</code> will send grep-able output to a file</li>
<li><code>-oX &lt;file_name&gt;</code> will output XML to a file</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h2 id="wireshark">Wireshark</h2>
<p>Wireshark is a GUI and command line tool for network monitoring and analysis. You can use it to record and later analyze or recreate network traffic. You can also use it to find malicous traffic on the network. It can run with promiscuous mode, where all network traffic on the interface is recorded, or without it, where only network traffic originating from or going to the monitoring computer is recorded. It must be run as an administrator to capture traffic (<code>sudo -E wireshark-gtk</code> on Linux systems).</p>
<h3 id="color-scheme">Color Scheme</h3>
<p>In the traffic pane, the traffic will be highlighted to correspond with different types of packets.</p>
<ul>
<li>Green - TCP traffic</li>
<li>Dark Blue - DNS traffic</li>
<li>Light Blue - UDP traffic</li>
<li>Black - TCP packets with problems</li>
</ul>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="capture-filters">Capture Filters</h3>
<pre class="wireshark"><code># bidirection capture
# capture IPv4 or IPv6 packets to and from a specific host
host 192.168.1.1

# capture packets to and from a subnet of IP addresses in CIDR notation
net 192.168.1.1/24 

# capture packets to and from a subnet of IP addresses in network mask notation
net 192.168.1.1 mask 255.255.255.0

# capture traffic only from one source
src net 192.168.1.1

# capture traffic only from a subnet of hosts in CIDR notation
src net 192.168.1.1/24

# capture packets from a range of IPs in subnet format
net 192.168.1.1 mask 255.255.255.0

# capture traffic on specific ports
port 21

# capture traffic for specific services
http
dns
ftp

# capture port range with specific protocol
tcp portrange 1-65535

# capture only IPv4 traffic
# useful when trying to observe traffic other than ARP and STP
ip

# capture only unicast traffic
# good for when you are trying to clear up noise on network
not broadcast and not multicast

# capture heartbleed attempts
tcp src port 443 and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4] = 0x18) and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4 + 1] = 0x03) and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4 + 2] &lt; 0x04) and ((ip[2:2] - 4 * (ip[0] &amp; 0x0F) - 4 * ((tcp[12] &amp; 0xF0) &gt;&gt; 4) &gt; 69)rc port 443 and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4] = 0x18) and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4 + 1] = 0x03) and (tcp[((tcp[12] &amp; 0xF0) &gt;&gt; 4 ) * 4 + 2] &lt; 0x04) and ((ip[2:2] - 4 * (ip[0] &amp; 0x0F) - 4 * ((tcp[12] &amp; 0xF0) &gt;&gt; 4) &gt; 69))</code></pre>
<p><a href="#top" title="top">Jump to Top</a></p>
<h1 id="appendix">Appendix</h1>
<h2 id="copyright">Copyright</h2>
<p>All documentation is licensed under the Creative Commons Attribution-ShareAlike 4.0 license. All code examples, unless otherwise specified, are licensed under the BSD 2-Clause license. The build system is licensed under the MIT license.</p>
<h3 id="creative-commons-attribution-sharealike-4.0-international-public-license">Creative Commons Attribution-ShareAlike 4.0 International Public License</h3>
<p>By exercising the Licensed Rights (defined below), You accept and agree to be bound by the terms and conditions of this Creative Commons Attribution-ShareAlike 4.0 International Public License (&quot;Public License&quot;). To the extent this Public License may be interpreted as a contract, You are granted the Licensed Rights in consideration of Your acceptance of these terms and conditions, and the Licensor grants You such rights in consideration of benefits the Licensor receives from making the Licensed Material available under these terms and conditions.</p>
<h4 id="section-1---definitions."><span id="Section-1">Section 1 - Definitions.</span></h4>
<ol style="list-style-type: decimal">
<li><strong>Adapted Material</strong> means material subject to Copyright and Similar Rights that is derived from or based upon the Licensed Material and in which the Licensed Material is translated, altered, arranged, transformed, or otherwise modified in a manner requiring permission under the Copyright and Similar Rights held by the Licensor. For purposes of this Public License, where the Licensed Material is a musical work, performance, or sound recording, Adapted Material is always produced where the Licensed Material is synched in timed relation with a moving image.</li>
<li><strong>Adapter's License</strong> means the license You apply to Your Copyright and Similar Rights in Your contributions to Adapted Material in accordance with the terms and conditions of this Public License.</li>
<li><strong>BY-SA</strong> Compatible License means a license listed at <a href="https://creativecommons.org/compatiblelicenses">creativecommons.org/compatiblelicenses</a>, approved by Creative Commons as essentially the equivalent of this Public License.</li>
<li><strong>Copyright and Similar Rights</strong> means copyright and/or similar rights closely related to copyright including, without limitation, performance, broadcast, sound recording, and Sui Generis Database Rights, without regard to how the rights are labeled or categorized. For purposes of this Public License, the rights specified in <a href="#Section-2-2-1">Section 2-2-1</a> are not Copyright and Similar Rights.</li>
<li><strong>Effective Technological Measures</strong> means those measures that, in the absence of proper authority, may not be circumvented under laws fulfilling obligations under Article 11 of the WIPO Copyright Treaty adopted on December 20, 1996, and/or similar international agreements.</li>
<li><strong>Exceptions and Limitations</strong> means fair use, fair dealing, and/or any other exception or limitation to Copyright and Similar Rights that applies to Your use of the Licensed Material.</li>
<li><strong>License Elements</strong> means the license attributes listed in the name of a Creative Commons Public License. The License Elements of this Public License are Attribution and ShareAlike.</li>
<li><strong>Licensed Material</strong> means the artistic or literary work, database, or other material to which the Licensor applied this Public License.</li>
<li><strong>Licensed Rights</strong> means the rights granted to You subject to the terms and conditions of this Public License, which are limited to all Copyright and Similar Rights that apply to Your use of the Licensed Material and that the Licensor has authority to license.</li>
<li><strong>Licensor</strong> means the individual(s) or entity(ies) granting rights under this Public License.</li>
<li><strong>Share</strong> means to provide material to the public by any means or process that requires permission under the Licensed Rights, such as reproduction, public display, public performance, distribution, dissemination, communication, or importation, and to make material available to the public including in ways that members of the public may access the material from a place and at a time individually chosen by them.</li>
<li><strong>Sui Generis Database Rights</strong> means rights other than copyright resulting from Directive 96/9/EC of the European Parliament and of the Council of 11 March 1996 on the legal protection of databases, as amended and/or succeeded, as well as other essentially equivalent rights anywhere in the world.</li>
<li><strong>You</strong> means the individual or entity exercising the Licensed Rights under this Public License. <strong>Your</strong> has a corresponding meaning.</li>
</ol>
<h4 id="section-2---scope."><span id="Section-2">Section 2 - Scope.</span></h4>
<ol style="list-style-type: decimal">
<li><strong>License grant.</strong>
<ol style="list-style-type: decimal">
<li><span id="Section-2-1-1">Subject to the terms and conditions of this Public License, the Licensor hereby grants You a worldwide, royalty-free, non-sublicensable, non-exclusive, irrevocable license to exercise the Licensed Rights in the Licensed Material to:</span>
<ol style="list-style-type: decimal">
<li>reproduce and Share the Licensed Material, in whole or in part; and</li>
<li>produce, reproduce, and Share Adapted Material.</li>
</ol></li>
<li><strong>Exceptions and Limitations.</strong> For the avoidance of doubt, where Exceptions and Limitations apply to Your use, this Public License does not apply, and You do not need to comply with its terms and conditions.</li>
<li><strong>Term.</strong> The term of this Public License is specified in <a href="#Section-6-1">Section 6-1</a>.</li>
<li><span id="Section-2-1-4"><strong>Media and formats; technical modifications allowed.</strong> The Licensor authorizes You to exercise the Licensed Rights in all media and formats whether now known or hereafter created, and to make technical modifications necessary to do so. The Licensor waives and/or agrees not to assert any right or authority to forbid You from making technical modifications necessary to exercise the Licensed Rights, including technical modifications necessary to circumvent Effective Technological Measures. For purposes of this Public License, simply making modifications authorized by this <a href="#Section-2-1-4">Section 2-1-4</a> never produces Adapted Material.</span></li>
<li><strong>Downstream recipients.</strong>
<ol style="list-style-type: decimal">
<li><strong>Offer from the Licensor – Licensed Material.</strong> Every recipient of the Licensed Material automatically receives an offer from the Licensor to exercise the Licensed Rights under the terms and conditions of this Public License.</li>
<li><strong>Additional offer from the Licensor – Adapted Material.</strong> Every recipient of Adapted Material from You automatically receives an offer from the Licensor to exercise the Licensed Rights in the Adapted Material under the conditions of the Adapter’s License You apply.</li>
<li><strong>No downstream restrictions.</strong> You may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, the Licensed Material if doing so restricts exercise of the Licensed Rights by any recipient of the Licensed Material.</li>
</ol></li>
<li><strong>No endorsement.</strong> Nothing in this Public License constitutes or may be construed as permission to assert or imply that You are, or that Your use of the Licensed Material is, connected with, or sponsored, endorsed, or granted official status by, the Licensor or others designated to receive attribution as provided in <a href="#Section-3-1-1-1-1">Section 3-1-1-1-1</a>.</li>
</ol></li>
<li><strong>Other rights.</strong>
<ol style="list-style-type: decimal">
<li><span id="Section-2-2-1">Moral rights, such as the right of integrity, are not licensed under this Public License, nor are publicity, privacy, and/or other similar personality rights; however, to the extent possible, the Licensor waives and/or agrees not to assert any such rights held by the Licensor to the limited extent necessary to allow You to exercise the Licensed Rights, but not otherwise.</span></li>
<li>Patent and trademark rights are not licensed under this Public License.</li>
<li>To the extent possible, the Licensor waives any right to collect royalties from You for the exercise of the Licensed Rights, whether directly or through a collecting society under any voluntary or waivable statutory or compulsory licensing scheme. In all other cases the Licensor expressly reserves any right to collect such royalties.</li>
</ol></li>
</ol>
<h4 id="section-3---license-conditions."><span id="Section-3">Section 3 - License Conditions.</span></h4>
<p>Your exercise of the Licensed Rights is expressly made subject to the following conditions.</p>
<ol style="list-style-type: decimal">
<li><span id="Section-3-1"><strong>Attribution.</strong></span>
<ol style="list-style-type: decimal">
<li><span id="Section-3-1-1">If You Share the Licensed Material (including in modified form), You must:</span>
<ol style="list-style-type: decimal">
<li><span id="Section-3-1-1-1">retain the following if it is supplied by the Licensor with the Licensed Material:</span>
<ol style="list-style-type: decimal">
<li><span id="Section-3-1-1-1-1">identification of the creator(s) of the Licensed Material and any others designated to receive attribution, in any reasonable manner requested by the Licensor (including by pseudonym if designated);</span></li>
<li>a copyright notice;</li>
<li>a notice that refers to this Public License;</li>
<li>a notice that refers to the disclaimer of warranties;</li>
<li>a URI or hyperlink to the Licensed Material to the extent reasonably practicable;</li>
</ol></li>
<li>indicate if You modified the Licensed Material and retain an indication of any previous modifications; and</li>
<li>indicate the Licensed Material is licensed under this Public License, and include the text of, or the URI or hyperlink to, this Public License.</li>
</ol></li>
<li><span id="Section-3-2">You may satisfy the conditions in <a href="#Section-3-1-1">Section 3-1-1</a> in any reasonable manner based on the medium, means, and context in which You Share the Licensed Material. For example, it may be reasonable to satisfy the conditions by providing a URI or hyperlink to a resource that includes the required information.</span></li>
<li>If requested by the Licensor, You must remove any of the information required by <a href="#Section-3-1-1-1">Section 3-1-1-1</a> to the extent reasonably practicable.</li>
</ol></li>
<li><p><strong>ShareAlike.</strong> In addition to the conditions in <a href="#Section-3-1">Section 3-1</a>, if You Share Adapted Material You produce, the following conditions also apply.</p>
<ol style="list-style-type: decimal">
<li>The Adapter’s License You apply must be a Creative Commons license with the same License Elements, this version or later, or a BY-SA Compatible License.</li>
<li>You must include the text of, or the URI or hyperlink to, the Adapter's License You apply. You may satisfy this condition in any reasonable manner based on the medium, means, and context in which You Share Adapted Material.</li>
<li>You may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, Adapted Material that restrict exercise of the rights granted under the Adapter's License You apply.</li>
</ol></li>
</ol>
<h4 id="section-4-sui-generis-database-rights."><span id="Section-4">Section 4 – Sui Generis Database Rights.</span></h4>
<p>Where the Licensed Rights include Sui Generis Database Rights that apply to Your use of the Licensed Material:</p>
<ol style="list-style-type: decimal">
<li>for the avoidance of doubt, <a href="#Section-2-1-1">Section 2-1-1</a> grants You the right to extract, reuse, reproduce, and Share all or a substantial portion of the contents of the database;</li>
<li>if You include all or a substantial portion of the database contents in a database in which You have Sui Generis Database Rights, then the database in which You have Sui Generis Database Rights (but not its individual contents) is Adapted Material, including for purposes of <a href="#Section-3-2">Section 3-2</a>; and</li>
<li>You must comply with the conditions in <a href="#Section-3-1">Section 3-1</a> if You Share all or a substantial portion of the contents of the database.</li>
</ol>
<p>For the avoidance of doubt, this <a href="#Section-4">Section 4</a> supplements and does not replace Your obligations under this Public License where the Licensed Rights include other Copyright and Similar Rights.</p>
<h4 id="section-5-disclaimer-of-warranties-and-limitation-of-liability."><span id="Section-5">Section 5 – Disclaimer of Warranties and Limitation of Liability.</span></h4>
<ol style="list-style-type: decimal">
<li><strong>Unless otherwise separately undertaken by the Licensor, to the extent possible, the Licensor offers the Licensed Material as-is and as-available, and makes no representations or warranties of any kind concerning the Licensed Material, whether express, implied, statutory, or other. This includes, without limitation, warranties of title, merchantability, fitness for a particular purpose, non-infringement, absence of latent or other defects, accuracy, or the presence or absence of errors, whether or not known or discoverable. Where disclaimers of warranties are not allowed in full or in part, this disclaimer may not apply to You.</strong></li>
<li><strong>To the extent possible, in no event will the Licensor be liable to You on any legal theory (including, without limitation, negligence) or otherwise for any direct, special, indirect, incidental, consequential, punitive, exemplary, or other losses, costs, expenses, or damages arising out of this Public License or use of the Licensed Material, even if the Licensor has been advised of the possibility of such losses, costs, expenses, or damages. Where a limitation of liability is not allowed in full or in part, this limitation may not apply to You.</strong></li>
<li>The disclaimer of warranties and limitation of liability provided above shall be interpreted in a manner that, to the extent possible, most closely approximates an absolute disclaimer and waiver of all liability.</li>
</ol>
<h4 id="section-6-term-and-termination."><span id="Section-6">Section 6 – Term and Termination.</span></h4>
<ol style="list-style-type: decimal">
<li><span id="Section-6-1">This Public License applies for the term of the Copyright and Similar Rights licensed here. However, if You fail to comply with this Public License, then Your rights under this Public License terminate automatically.</span></li>
<li><span id="Section-6-2">Where Your right to use the Licensed Material has terminated under <a href="#Section-6-1">Section 6-1</a>, it reinstates:</span>
<ol style="list-style-type: decimal">
<li>automatically as of the date the violation is cured, provided it is cured within 30 days of Your discovery of the violation; or</li>
<li>upon express reinstatement by the Licensor.</li>
</ol>
For the avoidance of doubt, this <a href="#Section-6-2">Section 6-2</a> does not affect any right the Licensor may have to seek remedies for Your violations of this Public License.</li>
<li>For the avoidance of doubt, the Licensor may also offer the Licensed Material under separate terms or conditions or stop distributing the Licensed Material at any time; however, doing so will not terminate this Public License.</li>
<li>Sections <a href="#Section-1">1</a>, <a href="#Section-5">5</a>, <a href="#Section-6">6</a>, <a href="#Section-7">7</a>, and <a href="#Section-8">8</a> survive termination of this Public License.</li>
</ol>
<h4 id="section-7-other-terms-and-conditions."><span id="Section-7">Section 7 – Other Terms and Conditions.</span></h4>
<ol style="list-style-type: decimal">
<li>The Licensor shall not be bound by any additional or different terms or conditions communicated by You unless expressly agreed.</li>
<li>Any arrangements, understandings, or agreements regarding the Licensed Material not stated herein are separate from and independent of the terms and conditions of this Public License.</li>
</ol>
<h4 id="section-8-interpretation."><span id="Section-8">Section 8 – Interpretation.</span></h4>
<ol style="list-style-type: decimal">
<li>For the avoidance of doubt, this Public License does not, and shall not be interpreted to, reduce, limit, restrict, or impose conditions on any use of the Licensed Material that could lawfully be made without permission under this Public License.</li>
<li>To the extent possible, if any provision of this Public License is deemed unenforceable, it shall be automatically reformed to the minimum extent necessary to make it enforceable. If the provision cannot be reformed, it shall be severed from this Public License without affecting the enforceability of the remaining terms and conditions.</li>
<li>No term or condition of this Public License will be waived and no failure to comply consented to unless expressly agreed to by the Licensor.</li>
<li>Nothing in this Public License constitutes or may be interpreted as a limitation upon, or waiver of, any privileges and immunities that apply to the Licensor or You, including from the legal processes of any jurisdiction or authority.</li>
</ol>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="bsd-2-clause">BSD 2-Clause</h3>
<p>Copyright (c) 2018, CU Cyber <a href="mailto:cyber@clemson.edu">cyber@clemson.edu</a></p>
<p>All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ol style="list-style-type: decimal">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
<h3 id="the-mit-license">The MIT License</h3>
<p>Copyright (c) 2018, CU Cyber <a href="mailto:cyber@clemson.edu">cyber@clemson.edu</a></p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<p><a href="#top" title="top">Jump to Top</a></p>
                                            </div>
                </div>
            </div>
        </section>
        <!--
        ==================================================
        Footer Section Start
        ================================================== -->
        <footer id="footer">
            <div class="container">
                <div class="col-md-8">
                    <p class="copyright">Copyright: <span>2018</span> CU Cyber &lt;cyber@clemson.edu&gt;. Design and Developed by <a href="http://www.Themefisher.com">Themefisher</a></p>
                </div>
            </div>
        </footer> <!-- /#footer -->
    </body>
</html>
